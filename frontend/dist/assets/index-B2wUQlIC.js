const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CourseView-C8njggUz.js","assets/vue-vendor-D7k_BbKJ.js","assets/element-plus-9A5k7Slw.js","assets/markdown-BKvX9Bk0.js","assets/mermaid-COPWorkx.js","assets/icons-8sQQqPP0.js","assets/CourseView-BKfFdYon.css"])))=>i.map(i=>d[i]);
import{aw as _s,d as ut,B as me,G as L,W as et,o as N,c as M,F as C,a as p,U as Z,R as W,M as Ie,a6 as Ee,I as X,u as T,H as tt,$ as be,r as ne,ac as ue,p as Ut,n as bs,S as ye,ax as Ht,e as fe,Z as vs,ay as xs,az as Ss,aA as Ts,at as Cs,aB as Is}from"./vue-vendor-D7k_BbKJ.js";import{L as x,d as D,M as st,N as _t,O as jt,P as Rs,Q as ks,R as $s,S as zt,T as bt,U as Ns,V as Yt,W as Es,X as As,Y as Os,Z as Ls,_ as Ms,$ as Ds,a0 as Ps,a1 as Fs,a2 as qs}from"./element-plus-9A5k7Slw.js";import{aU as vt}from"./mermaid-COPWorkx.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();function Gt(e,t){return function(){return e.apply(t,arguments)}}const{toString:Bs}=Object.prototype,{getPrototypeOf:ct}=Object,{iterator:je,toStringTag:Jt}=Symbol,ze=(e=>t=>{const s=Bs.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),ce=e=>(e=e.toLowerCase(),t=>ze(t)===e),Ye=e=>t=>typeof t===e,{isArray:ke}=Array,Re=Ye("undefined");function Ae(e){return e!==null&&!Re(e)&&e.constructor!==null&&!Re(e.constructor)&&re(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Qt=ce("ArrayBuffer");function Us(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Qt(e.buffer),t}const Hs=Ye("string"),re=Ye("function"),Vt=Ye("number"),Oe=e=>e!==null&&typeof e=="object",js=e=>e===!0||e===!1,qe=e=>{if(ze(e)!=="object")return!1;const t=ct(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Jt in e)&&!(je in e)},zs=e=>{if(!Oe(e)||Ae(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Ys=ce("Date"),Gs=ce("File"),Js=ce("Blob"),Qs=ce("FileList"),Vs=e=>Oe(e)&&re(e.pipe),Ws=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||re(e.append)&&((t=ze(e))==="formdata"||t==="object"&&re(e.toString)&&e.toString()==="[object FormData]"))},Ks=ce("URLSearchParams"),[Xs,Zs,en,tn]=["ReadableStream","Request","Response","Headers"].map(ce),sn=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Le(e,t,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let n,r;if(typeof e!="object"&&(e=[e]),ke(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{if(Ae(e))return;const o=s?Object.getOwnPropertyNames(e):Object.keys(e),i=o.length;let a;for(n=0;n<i;n++)a=o[n],t.call(null,e[a],a,e)}}function Wt(e,t){if(Ae(e))return null;t=t.toLowerCase();const s=Object.keys(e);let n=s.length,r;for(;n-- >0;)if(r=s[n],t===r.toLowerCase())return r;return null}const ve=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Kt=e=>!Re(e)&&e!==ve;function nt(){const{caseless:e,skipUndefined:t}=Kt(this)&&this||{},s={},n=(r,o)=>{if(o==="__proto__"||o==="constructor"||o==="prototype")return;const i=e&&Wt(s,o)||o;qe(s[i])&&qe(r)?s[i]=nt(s[i],r):qe(r)?s[i]=nt({},r):ke(r)?s[i]=r.slice():(!t||!Re(r))&&(s[i]=r)};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&Le(arguments[r],n);return s}const nn=(e,t,s,{allOwnKeys:n}={})=>(Le(t,(r,o)=>{s&&re(r)?Object.defineProperty(e,o,{value:Gt(r,s),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(e,o,{value:r,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:n}),e),rn=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),on=(e,t,s,n)=>{e.prototype=Object.create(t.prototype,n),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},an=(e,t,s,n)=>{let r,o,i;const a={};if(t=t||{},e==null)return t;do{for(r=Object.getOwnPropertyNames(e),o=r.length;o-- >0;)i=r[o],(!n||n(i,e,t))&&!a[i]&&(t[i]=e[i],a[i]=!0);e=s!==!1&&ct(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},ln=(e,t,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=t.length;const n=e.indexOf(t,s);return n!==-1&&n===s},un=e=>{if(!e)return null;if(ke(e))return e;let t=e.length;if(!Vt(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},cn=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ct(Uint8Array)),dn=(e,t)=>{const n=(e&&e[je]).call(e);let r;for(;(r=n.next())&&!r.done;){const o=r.value;t.call(e,o[0],o[1])}},hn=(e,t)=>{let s;const n=[];for(;(s=e.exec(t))!==null;)n.push(s);return n},fn=ce("HTMLFormElement"),pn=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,n,r){return n.toUpperCase()+r}),xt=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),gn=ce("RegExp"),Xt=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),n={};Le(s,(r,o)=>{let i;(i=t(r,o,e))!==!1&&(n[o]=i||r)}),Object.defineProperties(e,n)},mn=e=>{Xt(e,(t,s)=>{if(re(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const n=e[s];if(re(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},yn=(e,t)=>{const s={},n=r=>{r.forEach(o=>{s[o]=!0})};return ke(e)?n(e):n(String(e).split(t)),s},wn=()=>{},_n=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function bn(e){return!!(e&&re(e.append)&&e[Jt]==="FormData"&&e[je])}const vn=e=>{const t=new Array(10),s=(n,r)=>{if(Oe(n)){if(t.indexOf(n)>=0)return;if(Ae(n))return n;if(!("toJSON"in n)){t[r]=n;const o=ke(n)?[]:{};return Le(n,(i,a)=>{const d=s(i,r+1);!Re(d)&&(o[a]=d)}),t[r]=void 0,o}}return n};return s(e,0)},xn=ce("AsyncFunction"),Sn=e=>e&&(Oe(e)||re(e))&&re(e.then)&&re(e.catch),Zt=((e,t)=>e?setImmediate:t?((s,n)=>(ve.addEventListener("message",({source:r,data:o})=>{r===ve&&o===s&&n.length&&n.shift()()},!1),r=>{n.push(r),ve.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",re(ve.postMessage)),Tn=typeof queueMicrotask<"u"?queueMicrotask.bind(ve):typeof process<"u"&&process.nextTick||Zt,Cn=e=>e!=null&&re(e[je]),c={isArray:ke,isArrayBuffer:Qt,isBuffer:Ae,isFormData:Ws,isArrayBufferView:Us,isString:Hs,isNumber:Vt,isBoolean:js,isObject:Oe,isPlainObject:qe,isEmptyObject:zs,isReadableStream:Xs,isRequest:Zs,isResponse:en,isHeaders:tn,isUndefined:Re,isDate:Ys,isFile:Gs,isBlob:Js,isRegExp:gn,isFunction:re,isStream:Vs,isURLSearchParams:Ks,isTypedArray:cn,isFileList:Qs,forEach:Le,merge:nt,extend:nn,trim:sn,stripBOM:rn,inherits:on,toFlatObject:an,kindOf:ze,kindOfTest:ce,endsWith:ln,toArray:un,forEachEntry:dn,matchAll:hn,isHTMLForm:fn,hasOwnProperty:xt,hasOwnProp:xt,reduceDescriptors:Xt,freezeMethods:mn,toObjectSet:yn,toCamelCase:pn,noop:wn,toFiniteNumber:_n,findKey:Wt,global:ve,isContextDefined:Kt,isSpecCompliantForm:bn,toJSONObject:vn,isAsyncFn:xn,isThenable:Sn,setImmediate:Zt,asap:Tn,isIterable:Cn};let k=class es extends Error{static from(t,s,n,r,o,i){const a=new es(t.message,s||t.code,n,r,o);return a.cause=t,a.name=t.name,i&&Object.assign(a,i),a}constructor(t,s,n,r,o){super(t),this.name="AxiosError",this.isAxiosError=!0,s&&(this.code=s),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o,this.status=o.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:c.toJSONObject(this.config),code:this.code,status:this.status}}};k.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";k.ERR_BAD_OPTION="ERR_BAD_OPTION";k.ECONNABORTED="ECONNABORTED";k.ETIMEDOUT="ETIMEDOUT";k.ERR_NETWORK="ERR_NETWORK";k.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";k.ERR_DEPRECATED="ERR_DEPRECATED";k.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";k.ERR_BAD_REQUEST="ERR_BAD_REQUEST";k.ERR_CANCELED="ERR_CANCELED";k.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";k.ERR_INVALID_URL="ERR_INVALID_URL";const In=null;function rt(e){return c.isPlainObject(e)||c.isArray(e)}function ts(e){return c.endsWith(e,"[]")?e.slice(0,-2):e}function St(e,t,s){return e?e.concat(t).map(function(r,o){return r=ts(r),!s&&o?"["+r+"]":r}).join(s?".":""):t}function Rn(e){return c.isArray(e)&&!e.some(rt)}const kn=c.toFlatObject(c,{},null,function(t){return/^is[A-Z]/.test(t)});function Ge(e,t,s){if(!c.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,s=c.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,w){return!c.isUndefined(w[S])});const n=s.metaTokens,r=s.visitor||u,o=s.dots,i=s.indexes,d=(s.Blob||typeof Blob<"u"&&Blob)&&c.isSpecCompliantForm(t);if(!c.isFunction(r))throw new TypeError("visitor must be a function");function l(g){if(g===null)return"";if(c.isDate(g))return g.toISOString();if(c.isBoolean(g))return g.toString();if(!d&&c.isBlob(g))throw new k("Blob is not supported. Use a Buffer instead.");return c.isArrayBuffer(g)||c.isTypedArray(g)?d&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function u(g,S,w){let P=g;if(g&&!w&&typeof g=="object"){if(c.endsWith(S,"{}"))S=n?S:S.slice(0,-2),g=JSON.stringify(g);else if(c.isArray(g)&&Rn(g)||(c.isFileList(g)||c.endsWith(S,"[]"))&&(P=c.toArray(g)))return S=ts(S),P.forEach(function(F,B){!(c.isUndefined(F)||F===null)&&t.append(i===!0?St([S],B,o):i===null?S:S+"[]",l(F))}),!1}return rt(g)?!0:(t.append(St(w,S,o),l(g)),!1)}const f=[],b=Object.assign(kn,{defaultVisitor:u,convertValue:l,isVisitable:rt});function I(g,S){if(!c.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+S.join("."));f.push(g),c.forEach(g,function(P,V){(!(c.isUndefined(P)||P===null)&&r.call(t,P,c.isString(V)?V.trim():V,S,b))===!0&&I(P,S?S.concat(V):[V])}),f.pop()}}if(!c.isObject(e))throw new TypeError("data must be an object");return I(e),t}function Tt(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function dt(e,t){this._pairs=[],e&&Ge(e,this,t)}const ss=dt.prototype;ss.append=function(t,s){this._pairs.push([t,s])};ss.toString=function(t){const s=t?function(n){return t.call(this,n,Tt)}:Tt;return this._pairs.map(function(r){return s(r[0])+"="+s(r[1])},"").join("&")};function $n(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ns(e,t,s){if(!t)return e;const n=s&&s.encode||$n,r=c.isFunction(s)?{serialize:s}:s,o=r&&r.serialize;let i;if(o?i=o(t,r):i=c.isURLSearchParams(t)?t.toString():new dt(t,r).toString(n),i){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Ct{constructor(){this.handlers=[]}use(t,s,n){return this.handlers.push({fulfilled:t,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){c.forEach(this.handlers,function(n){n!==null&&t(n)})}}const ht={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1,legacyInterceptorReqResOrdering:!0},Nn=typeof URLSearchParams<"u"?URLSearchParams:dt,En=typeof FormData<"u"?FormData:null,An=typeof Blob<"u"?Blob:null,On={isBrowser:!0,classes:{URLSearchParams:Nn,FormData:En,Blob:An},protocols:["http","https","file","blob","url","data"]},ft=typeof window<"u"&&typeof document<"u",ot=typeof navigator=="object"&&navigator||void 0,Ln=ft&&(!ot||["ReactNative","NativeScript","NS"].indexOf(ot.product)<0),Mn=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Dn=ft&&window.location.href||"http://localhost",Pn=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ft,hasStandardBrowserEnv:Ln,hasStandardBrowserWebWorkerEnv:Mn,navigator:ot,origin:Dn},Symbol.toStringTag,{value:"Module"})),ee={...Pn,...On};function Fn(e,t){return Ge(e,new ee.classes.URLSearchParams,{visitor:function(s,n,r,o){return ee.isNode&&c.isBuffer(s)?(this.append(n,s.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...t})}function qn(e){return c.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Bn(e){const t={},s=Object.keys(e);let n;const r=s.length;let o;for(n=0;n<r;n++)o=s[n],t[o]=e[o];return t}function rs(e){function t(s,n,r,o){let i=s[o++];if(i==="__proto__")return!0;const a=Number.isFinite(+i),d=o>=s.length;return i=!i&&c.isArray(r)?r.length:i,d?(c.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!a):((!r[i]||!c.isObject(r[i]))&&(r[i]=[]),t(s,n,r[i],o)&&c.isArray(r[i])&&(r[i]=Bn(r[i])),!a)}if(c.isFormData(e)&&c.isFunction(e.entries)){const s={};return c.forEachEntry(e,(n,r)=>{t(qn(n),r,s,0)}),s}return null}function Un(e,t,s){if(c.isString(e))try{return(t||JSON.parse)(e),c.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(e)}const Me={transitional:ht,adapter:["xhr","http","fetch"],transformRequest:[function(t,s){const n=s.getContentType()||"",r=n.indexOf("application/json")>-1,o=c.isObject(t);if(o&&c.isHTMLForm(t)&&(t=new FormData(t)),c.isFormData(t))return r?JSON.stringify(rs(t)):t;if(c.isArrayBuffer(t)||c.isBuffer(t)||c.isStream(t)||c.isFile(t)||c.isBlob(t)||c.isReadableStream(t))return t;if(c.isArrayBufferView(t))return t.buffer;if(c.isURLSearchParams(t))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Fn(t,this.formSerializer).toString();if((a=c.isFileList(t))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Ge(a?{"files[]":t}:t,d&&new d,this.formSerializer)}}return o||r?(s.setContentType("application/json",!1),Un(t)):t}],transformResponse:[function(t){const s=this.transitional||Me.transitional,n=s&&s.forcedJSONParsing,r=this.responseType==="json";if(c.isResponse(t)||c.isReadableStream(t))return t;if(t&&c.isString(t)&&(n&&!this.responseType||r)){const i=!(s&&s.silentJSONParsing)&&r;try{return JSON.parse(t,this.parseReviver)}catch(a){if(i)throw a.name==="SyntaxError"?k.from(a,k.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ee.classes.FormData,Blob:ee.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};c.forEach(["delete","get","head","post","put","patch"],e=>{Me.headers[e]={}});const Hn=c.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jn=e=>{const t={};let s,n,r;return e&&e.split(`
`).forEach(function(i){r=i.indexOf(":"),s=i.substring(0,r).trim().toLowerCase(),n=i.substring(r+1).trim(),!(!s||t[s]&&Hn[s])&&(s==="set-cookie"?t[s]?t[s].push(n):t[s]=[n]:t[s]=t[s]?t[s]+", "+n:n)}),t},It=Symbol("internals");function Ne(e){return e&&String(e).trim().toLowerCase()}function Be(e){return e===!1||e==null?e:c.isArray(e)?e.map(Be):String(e)}function zn(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=s.exec(e);)t[n[1]]=n[2];return t}const Yn=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function We(e,t,s,n,r){if(c.isFunction(n))return n.call(this,t,s);if(r&&(t=s),!!c.isString(t)){if(c.isString(n))return t.indexOf(n)!==-1;if(c.isRegExp(n))return n.test(t)}}function Gn(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,s,n)=>s.toUpperCase()+n)}function Jn(e,t){const s=c.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+s,{value:function(r,o,i){return this[n].call(this,t,r,o,i)},configurable:!0})})}let oe=class{constructor(t){t&&this.set(t)}set(t,s,n){const r=this;function o(a,d,l){const u=Ne(d);if(!u)throw new Error("header name must be a non-empty string");const f=c.findKey(r,u);(!f||r[f]===void 0||l===!0||l===void 0&&r[f]!==!1)&&(r[f||d]=Be(a))}const i=(a,d)=>c.forEach(a,(l,u)=>o(l,u,d));if(c.isPlainObject(t)||t instanceof this.constructor)i(t,s);else if(c.isString(t)&&(t=t.trim())&&!Yn(t))i(jn(t),s);else if(c.isObject(t)&&c.isIterable(t)){let a={},d,l;for(const u of t){if(!c.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[l=u[0]]=(d=a[l])?c.isArray(d)?[...d,u[1]]:[d,u[1]]:u[1]}i(a,s)}else t!=null&&o(s,t,n);return this}get(t,s){if(t=Ne(t),t){const n=c.findKey(this,t);if(n){const r=this[n];if(!s)return r;if(s===!0)return zn(r);if(c.isFunction(s))return s.call(this,r,n);if(c.isRegExp(s))return s.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,s){if(t=Ne(t),t){const n=c.findKey(this,t);return!!(n&&this[n]!==void 0&&(!s||We(this,this[n],n,s)))}return!1}delete(t,s){const n=this;let r=!1;function o(i){if(i=Ne(i),i){const a=c.findKey(n,i);a&&(!s||We(n,n[a],a,s))&&(delete n[a],r=!0)}}return c.isArray(t)?t.forEach(o):o(t),r}clear(t){const s=Object.keys(this);let n=s.length,r=!1;for(;n--;){const o=s[n];(!t||We(this,this[o],o,t,!0))&&(delete this[o],r=!0)}return r}normalize(t){const s=this,n={};return c.forEach(this,(r,o)=>{const i=c.findKey(n,o);if(i){s[i]=Be(r),delete s[o];return}const a=t?Gn(o):String(o).trim();a!==o&&delete s[o],s[a]=Be(r),n[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const s=Object.create(null);return c.forEach(this,(n,r)=>{n!=null&&n!==!1&&(s[r]=t&&c.isArray(n)?n.join(", "):n)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,s])=>t+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...s){const n=new this(t);return s.forEach(r=>n.set(r)),n}static accessor(t){const n=(this[It]=this[It]={accessors:{}}).accessors,r=this.prototype;function o(i){const a=Ne(i);n[a]||(Jn(r,i),n[a]=!0)}return c.isArray(t)?t.forEach(o):o(t),this}};oe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);c.reduceDescriptors(oe.prototype,({value:e},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[s]=n}}});c.freezeMethods(oe);function Ke(e,t){const s=this||Me,n=t||s,r=oe.from(n.headers);let o=n.data;return c.forEach(e,function(a){o=a.call(s,o,r.normalize(),t?t.status:void 0)}),r.normalize(),o}function os(e){return!!(e&&e.__CANCEL__)}let De=class extends k{constructor(t,s,n){super(t??"canceled",k.ERR_CANCELED,s,n),this.name="CanceledError",this.__CANCEL__=!0}};function is(e,t,s){const n=s.config.validateStatus;!s.status||!n||n(s.status)?e(s):t(new k("Request failed with status code "+s.status,[k.ERR_BAD_REQUEST,k.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Qn(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Vn(e,t){e=e||10;const s=new Array(e),n=new Array(e);let r=0,o=0,i;return t=t!==void 0?t:1e3,function(d){const l=Date.now(),u=n[o];i||(i=l),s[r]=d,n[r]=l;let f=o,b=0;for(;f!==r;)b+=s[f++],f=f%e;if(r=(r+1)%e,r===o&&(o=(o+1)%e),l-i<t)return;const I=u&&l-u;return I?Math.round(b*1e3/I):void 0}}function Wn(e,t){let s=0,n=1e3/t,r,o;const i=(l,u=Date.now())=>{s=u,r=null,o&&(clearTimeout(o),o=null),e(...l)};return[(...l)=>{const u=Date.now(),f=u-s;f>=n?i(l,u):(r=l,o||(o=setTimeout(()=>{o=null,i(r)},n-f)))},()=>r&&i(r)]}const He=(e,t,s=3)=>{let n=0;const r=Vn(50,250);return Wn(o=>{const i=o.loaded,a=o.lengthComputable?o.total:void 0,d=i-n,l=r(d),u=i<=a;n=i;const f={loaded:i,total:a,progress:a?i/a:void 0,bytes:d,rate:l||void 0,estimated:l&&a&&u?(a-i)/l:void 0,event:o,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(f)},s)},Rt=(e,t)=>{const s=e!=null;return[n=>t[0]({lengthComputable:s,total:e,loaded:n}),t[1]]},kt=e=>(...t)=>c.asap(()=>e(...t)),Kn=ee.hasStandardBrowserEnv?((e,t)=>s=>(s=new URL(s,ee.origin),e.protocol===s.protocol&&e.host===s.host&&(t||e.port===s.port)))(new URL(ee.origin),ee.navigator&&/(msie|trident)/i.test(ee.navigator.userAgent)):()=>!0,Xn=ee.hasStandardBrowserEnv?{write(e,t,s,n,r,o,i){if(typeof document>"u")return;const a=[`${e}=${encodeURIComponent(t)}`];c.isNumber(s)&&a.push(`expires=${new Date(s).toUTCString()}`),c.isString(n)&&a.push(`path=${n}`),c.isString(r)&&a.push(`domain=${r}`),o===!0&&a.push("secure"),c.isString(i)&&a.push(`SameSite=${i}`),document.cookie=a.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Zn(e){return typeof e!="string"?!1:/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function er(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function as(e,t,s){let n=!Zn(t);return e&&(n||s==!1)?er(e,t):t}const $t=e=>e instanceof oe?{...e}:e;function Se(e,t){t=t||{};const s={};function n(l,u,f,b){return c.isPlainObject(l)&&c.isPlainObject(u)?c.merge.call({caseless:b},l,u):c.isPlainObject(u)?c.merge({},u):c.isArray(u)?u.slice():u}function r(l,u,f,b){if(c.isUndefined(u)){if(!c.isUndefined(l))return n(void 0,l,f,b)}else return n(l,u,f,b)}function o(l,u){if(!c.isUndefined(u))return n(void 0,u)}function i(l,u){if(c.isUndefined(u)){if(!c.isUndefined(l))return n(void 0,l)}else return n(void 0,u)}function a(l,u,f){if(f in t)return n(l,u);if(f in e)return n(void 0,l)}const d={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(l,u,f)=>r($t(l),$t(u),f,!0)};return c.forEach(Object.keys({...e,...t}),function(u){if(u==="__proto__"||u==="constructor"||u==="prototype")return;const f=c.hasOwnProp(d,u)?d[u]:r,b=f(e[u],t[u],u);c.isUndefined(b)&&f!==a||(s[u]=b)}),s}const ls=e=>{const t=Se({},e);let{data:s,withXSRFToken:n,xsrfHeaderName:r,xsrfCookieName:o,headers:i,auth:a}=t;if(t.headers=i=oe.from(i),t.url=ns(as(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&i.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),c.isFormData(s)){if(ee.hasStandardBrowserEnv||ee.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(c.isFunction(s.getHeaders)){const d=s.getHeaders(),l=["content-type","content-length"];Object.entries(d).forEach(([u,f])=>{l.includes(u.toLowerCase())&&i.set(u,f)})}}if(ee.hasStandardBrowserEnv&&(n&&c.isFunction(n)&&(n=n(t)),n||n!==!1&&Kn(t.url))){const d=r&&o&&Xn.read(o);d&&i.set(r,d)}return t},tr=typeof XMLHttpRequest<"u",sr=tr&&function(e){return new Promise(function(s,n){const r=ls(e);let o=r.data;const i=oe.from(r.headers).normalize();let{responseType:a,onUploadProgress:d,onDownloadProgress:l}=r,u,f,b,I,g;function S(){I&&I(),g&&g(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let w=new XMLHttpRequest;w.open(r.method.toUpperCase(),r.url,!0),w.timeout=r.timeout;function P(){if(!w)return;const F=oe.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),m={data:!a||a==="text"||a==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:F,config:e,request:w};is(function($){s($),S()},function($){n($),S()},m),w=null}"onloadend"in w?w.onloadend=P:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(P)},w.onabort=function(){w&&(n(new k("Request aborted",k.ECONNABORTED,e,w)),w=null)},w.onerror=function(B){const m=B&&B.message?B.message:"Network Error",h=new k(m,k.ERR_NETWORK,e,w);h.event=B||null,n(h),w=null},w.ontimeout=function(){let B=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const m=r.transitional||ht;r.timeoutErrorMessage&&(B=r.timeoutErrorMessage),n(new k(B,m.clarifyTimeoutError?k.ETIMEDOUT:k.ECONNABORTED,e,w)),w=null},o===void 0&&i.setContentType(null),"setRequestHeader"in w&&c.forEach(i.toJSON(),function(B,m){w.setRequestHeader(m,B)}),c.isUndefined(r.withCredentials)||(w.withCredentials=!!r.withCredentials),a&&a!=="json"&&(w.responseType=r.responseType),l&&([b,g]=He(l,!0),w.addEventListener("progress",b)),d&&w.upload&&([f,I]=He(d),w.upload.addEventListener("progress",f),w.upload.addEventListener("loadend",I)),(r.cancelToken||r.signal)&&(u=F=>{w&&(n(!F||F.type?new De(null,e,w):F),w.abort(),w=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const V=Qn(r.url);if(V&&ee.protocols.indexOf(V)===-1){n(new k("Unsupported protocol "+V+":",k.ERR_BAD_REQUEST,e));return}w.send(o||null)})},nr=(e,t)=>{const{length:s}=e=e?e.filter(Boolean):[];if(t||s){let n=new AbortController,r;const o=function(l){if(!r){r=!0,a();const u=l instanceof Error?l:this.reason;n.abort(u instanceof k?u:new De(u instanceof Error?u.message:u))}};let i=t&&setTimeout(()=>{i=null,o(new k(`timeout of ${t}ms exceeded`,k.ETIMEDOUT))},t);const a=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(o):l.removeEventListener("abort",o)}),e=null)};e.forEach(l=>l.addEventListener("abort",o));const{signal:d}=n;return d.unsubscribe=()=>c.asap(a),d}},rr=function*(e,t){let s=e.byteLength;if(s<t){yield e;return}let n=0,r;for(;n<s;)r=n+t,yield e.slice(n,r),n=r},or=async function*(e,t){for await(const s of ir(e))yield*rr(s,t)},ir=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:s,value:n}=await t.read();if(s)break;yield n}}finally{await t.cancel()}},Nt=(e,t,s,n)=>{const r=or(e,t);let o=0,i,a=d=>{i||(i=!0,n&&n(d))};return new ReadableStream({async pull(d){try{const{done:l,value:u}=await r.next();if(l){a(),d.close();return}let f=u.byteLength;if(s){let b=o+=f;s(b)}d.enqueue(new Uint8Array(u))}catch(l){throw a(l),l}},cancel(d){return a(d),r.return()}},{highWaterMark:2})},Et=64*1024,{isFunction:Pe}=c,ar=(({Request:e,Response:t})=>({Request:e,Response:t}))(c.global),{ReadableStream:At,TextEncoder:Ot}=c.global,Lt=(e,...t)=>{try{return!!e(...t)}catch{return!1}},lr=e=>{e=c.merge.call({skipUndefined:!0},ar,e);const{fetch:t,Request:s,Response:n}=e,r=t?Pe(t):typeof fetch=="function",o=Pe(s),i=Pe(n);if(!r)return!1;const a=r&&Pe(At),d=r&&(typeof Ot=="function"?(g=>S=>g.encode(S))(new Ot):async g=>new Uint8Array(await new s(g).arrayBuffer())),l=o&&a&&Lt(()=>{let g=!1;const S=new s(ee.origin,{body:new At,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!S}),u=i&&a&&Lt(()=>c.isReadableStream(new n("").body)),f={stream:u&&(g=>g.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!f[g]&&(f[g]=(S,w)=>{let P=S&&S[g];if(P)return P.call(S);throw new k(`Response type '${g}' is not supported`,k.ERR_NOT_SUPPORT,w)})});const b=async g=>{if(g==null)return 0;if(c.isBlob(g))return g.size;if(c.isSpecCompliantForm(g))return(await new s(ee.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(c.isArrayBufferView(g)||c.isArrayBuffer(g))return g.byteLength;if(c.isURLSearchParams(g)&&(g=g+""),c.isString(g))return(await d(g)).byteLength},I=async(g,S)=>{const w=c.toFiniteNumber(g.getContentLength());return w??b(S)};return async g=>{let{url:S,method:w,data:P,signal:V,cancelToken:F,timeout:B,onDownloadProgress:m,onUploadProgress:h,responseType:$,headers:z,withCredentials:R="same-origin",fetchOptions:K}=ls(g),U=t||fetch;$=$?($+"").toLowerCase():"text";let Y=nr([V,F&&F.toAbortSignal()],B),G=null;const J=Y&&Y.unsubscribe&&(()=>{Y.unsubscribe()});let de;try{if(h&&l&&w!=="get"&&w!=="head"&&(de=await I(z,P))!==0){let le=new s(S,{method:"POST",body:P,duplex:"half"}),_;if(c.isFormData(P)&&(_=le.headers.get("content-type"))&&z.setContentType(_),le.body){const[y,v]=Rt(de,He(kt(h)));P=Nt(le.body,Et,y,v)}}c.isString(R)||(R=R?"include":"omit");const A=o&&"credentials"in s.prototype,ie={...K,signal:Y,method:w.toUpperCase(),headers:z.normalize().toJSON(),body:P,duplex:"half",credentials:A?R:void 0};G=o&&new s(S,ie);let te=await(o?U(G,K):U(S,ie));const pe=u&&($==="stream"||$==="response");if(u&&(m||pe&&J)){const le={};["status","statusText","headers"].forEach(H=>{le[H]=te[H]});const _=c.toFiniteNumber(te.headers.get("content-length")),[y,v]=m&&Rt(_,He(kt(m),!0))||[];te=new n(Nt(te.body,Et,y,()=>{v&&v(),J&&J()}),le)}$=$||"text";let $e=await f[c.findKey(f,$)||"text"](te,g);return!pe&&J&&J(),await new Promise((le,_)=>{is(le,_,{data:$e,headers:oe.from(te.headers),status:te.status,statusText:te.statusText,config:g,request:G})})}catch(A){throw J&&J(),A&&A.name==="TypeError"&&/Load failed|fetch/i.test(A.message)?Object.assign(new k("Network Error",k.ERR_NETWORK,g,G,A&&A.response),{cause:A.cause||A}):k.from(A,A&&A.code,g,G,A&&A.response)}}},ur=new Map,us=e=>{let t=e&&e.env||{};const{fetch:s,Request:n,Response:r}=t,o=[n,r,s];let i=o.length,a=i,d,l,u=ur;for(;a--;)d=o[a],l=u.get(d),l===void 0&&u.set(d,l=a?new Map:lr(t)),u=l;return l};us();const pt={http:In,xhr:sr,fetch:{get:us}};c.forEach(pt,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Mt=e=>`- ${e}`,cr=e=>c.isFunction(e)||e===null||e===!1;function dr(e,t){e=c.isArray(e)?e:[e];const{length:s}=e;let n,r;const o={};for(let i=0;i<s;i++){n=e[i];let a;if(r=n,!cr(n)&&(r=pt[(a=String(n)).toLowerCase()],r===void 0))throw new k(`Unknown adapter '${a}'`);if(r&&(c.isFunction(r)||(r=r.get(t))))break;o[a||"#"+i]=r}if(!r){const i=Object.entries(o).map(([d,l])=>`adapter ${d} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=s?i.length>1?`since :
`+i.map(Mt).join(`
`):" "+Mt(i[0]):"as no adapter specified";throw new k("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r}const cs={getAdapter:dr,adapters:pt};function Xe(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new De(null,e)}function Dt(e){return Xe(e),e.headers=oe.from(e.headers),e.data=Ke.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),cs.getAdapter(e.adapter||Me.adapter,e)(e).then(function(n){return Xe(e),n.data=Ke.call(e,e.transformResponse,n),n.headers=oe.from(n.headers),n},function(n){return os(n)||(Xe(e),n&&n.response&&(n.response.data=Ke.call(e,e.transformResponse,n.response),n.response.headers=oe.from(n.response.headers))),Promise.reject(n)})}const ds="1.13.5",Je={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Je[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Pt={};Je.transitional=function(t,s,n){function r(o,i){return"[Axios v"+ds+"] Transitional option '"+o+"'"+i+(n?". "+n:"")}return(o,i,a)=>{if(t===!1)throw new k(r(i," has been removed"+(s?" in "+s:"")),k.ERR_DEPRECATED);return s&&!Pt[i]&&(Pt[i]=!0,console.warn(r(i," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(o,i,a):!0}};Je.spelling=function(t){return(s,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function hr(e,t,s){if(typeof e!="object")throw new k("options must be an object",k.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let r=n.length;for(;r-- >0;){const o=n[r],i=t[o];if(i){const a=e[o],d=a===void 0||i(a,o,e);if(d!==!0)throw new k("option "+o+" must be "+d,k.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new k("Unknown option "+o,k.ERR_BAD_OPTION)}}const Ue={assertOptions:hr,validators:Je},ae=Ue.validators;let xe=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Ct,response:new Ct}}async request(t,s){try{return await this._request(t,s)}catch(n){if(n instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const o=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=Se(this.defaults,s);const{transitional:n,paramsSerializer:r,headers:o}=s;n!==void 0&&Ue.assertOptions(n,{silentJSONParsing:ae.transitional(ae.boolean),forcedJSONParsing:ae.transitional(ae.boolean),clarifyTimeoutError:ae.transitional(ae.boolean),legacyInterceptorReqResOrdering:ae.transitional(ae.boolean)},!1),r!=null&&(c.isFunction(r)?s.paramsSerializer={serialize:r}:Ue.assertOptions(r,{encode:ae.function,serialize:ae.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),Ue.assertOptions(s,{baseUrl:ae.spelling("baseURL"),withXsrfToken:ae.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let i=o&&c.merge(o.common,o[s.method]);o&&c.forEach(["delete","get","head","post","put","patch","common"],g=>{delete o[g]}),s.headers=oe.concat(i,o);const a=[];let d=!0;this.interceptors.request.forEach(function(S){if(typeof S.runWhen=="function"&&S.runWhen(s)===!1)return;d=d&&S.synchronous;const w=s.transitional||ht;w&&w.legacyInterceptorReqResOrdering?a.unshift(S.fulfilled,S.rejected):a.push(S.fulfilled,S.rejected)});const l=[];this.interceptors.response.forEach(function(S){l.push(S.fulfilled,S.rejected)});let u,f=0,b;if(!d){const g=[Dt.bind(this),void 0];for(g.unshift(...a),g.push(...l),b=g.length,u=Promise.resolve(s);f<b;)u=u.then(g[f++],g[f++]);return u}b=a.length;let I=s;for(;f<b;){const g=a[f++],S=a[f++];try{I=g(I)}catch(w){S.call(this,w);break}}try{u=Dt.call(this,I)}catch(g){return Promise.reject(g)}for(f=0,b=l.length;f<b;)u=u.then(l[f++],l[f++]);return u}getUri(t){t=Se(this.defaults,t);const s=as(t.baseURL,t.url,t.allowAbsoluteUrls);return ns(s,t.params,t.paramsSerializer)}};c.forEach(["delete","get","head","options"],function(t){xe.prototype[t]=function(s,n){return this.request(Se(n||{},{method:t,url:s,data:(n||{}).data}))}});c.forEach(["post","put","patch"],function(t){function s(n){return function(o,i,a){return this.request(Se(a||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}xe.prototype[t]=s(),xe.prototype[t+"Form"]=s(!0)});let fr=class hs{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(o){s=o});const n=this;this.promise.then(r=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](r);n._listeners=null}),this.promise.then=r=>{let o;const i=new Promise(a=>{n.subscribe(a),o=a}).then(r);return i.cancel=function(){n.unsubscribe(o)},i},t(function(o,i,a){n.reason||(n.reason=new De(o,i,a),s(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const t=new AbortController,s=n=>{t.abort(n)};return this.subscribe(s),t.signal.unsubscribe=()=>this.unsubscribe(s),t.signal}static source(){let t;return{token:new hs(function(r){t=r}),cancel:t}}};function pr(e){return function(s){return e.apply(null,s)}}function gr(e){return c.isObject(e)&&e.isAxiosError===!0}const it={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(it).forEach(([e,t])=>{it[t]=e});function fs(e){const t=new xe(e),s=Gt(xe.prototype.request,t);return c.extend(s,xe.prototype,t,{allOwnKeys:!0}),c.extend(s,t,null,{allOwnKeys:!0}),s.create=function(r){return fs(Se(e,r))},s}const j=fs(Me);j.Axios=xe;j.CanceledError=De;j.CancelToken=fr;j.isCancel=os;j.VERSION=ds;j.toFormData=Ge;j.AxiosError=k;j.Cancel=j.CanceledError;j.all=function(t){return Promise.all(t)};j.spread=pr;j.isAxiosError=gr;j.mergeConfig=Se;j.AxiosHeaders=oe;j.formToJSON=e=>rs(c.isHTMLForm(e)?new FormData(e):e);j.getAdapter=cs.getAdapter;j.HttpStatusCode=it;j.default=j;const{Axios:ai,AxiosError:li,CanceledError:ui,isCancel:ci,CancelToken:di,VERSION:hi,all:fi,Cancel:pi,isAxiosError:gi,spread:mi,toFormData:yi,AxiosHeaders:wi,HttpStatusCode:_i,formToJSON:bi,getAdapter:vi,mergeConfig:xi}=j,mr="http://localhost:8000",O=j.create({baseURL:mr,timeout:18e4,headers:{"Content-Type":"application/json"}});O.interceptors.request.use(e=>e,e=>Promise.reject(e));O.interceptors.response.use(e=>e,e=>{let t="ËØ∑Ê±ÇÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï";if(e.response){switch(e.response.status){case 400:t="ËØ∑Ê±ÇÂèÇÊï∞ÈîôËØØ";break;case 401:t="Êú™ÊéàÊùÉÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï";break;case 403:t="ÊãíÁªùËÆøÈóÆ";break;case 404:t="ËØ∑Ê±ÇËµÑÊ∫êÊú™ÊâæÂà∞";break;case 500:t="ÊúçÂä°Âô®ÂÜÖÈÉ®ÈîôËØØ";break;default:t=`ËØ∑Ê±ÇÈîôËØØ: ${e.response.status}`}const s=e.response.data;s&&s.detail&&(t=s.detail)}else e.request?t="ÁΩëÁªúËøûÊé•Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËÆæÁΩÆ":t=e.message;return x.error(t),Promise.reject(e)});const Ft=[1,2,4,7,15,30,60,90],yr=.7,wr={easy:1.3,medium:1,hard:.8,very_hard:.6};function ps(e,t="medium",s=1){const n=Ft[Math.min(e,Ft.length-1)]??1,r=wr[t],o=Math.max(.5,s),i=Math.round(n*r*o);return D().add(i,"day").valueOf()}function _r(e,t){const s=D().diff(D(e),"day",!0),n=1+t*.5,r=Math.exp(-s/n);return Math.max(0,Math.min(1,r))}function br(e,t){const s=Date.now();let n=e.difficulty;t>=4?n="easy":t>=3?n="medium":t>=2?n="hard":n="very_hard";const r=t/5,o=Math.min(1,e.masteryLevel+t/5*.2),i=ps(e.reviewCount+1,n,r);return{...e,lastReviewedAt:s,nextReviewAt:i,reviewCount:e.reviewCount+1,difficulty:n,retentionRate:r,masteryLevel:o,isForgotten:t<3}}function at(e){const t=D().startOf("day").valueOf(),s=D().endOf("day").valueOf(),n={today:[],upcoming:[],overdue:[],mastered:[]};e.forEach(o=>{if(o.masteryLevel>.9&&o.reviewCount>=3){n.mastered.push(o);return}if(o.nextReviewAt<t){n.overdue.push(o);return}if(o.nextReviewAt>=t&&o.nextReviewAt<=s){n.today.push(o);return}o.nextReviewAt>s&&n.upcoming.push(o)});const r=(o,i)=>{if(o.isForgotten!==i.isForgotten)return o.isForgotten?-1:1;const a=o.nextReviewAt-i.nextReviewAt;return Math.abs(a)>864e5?a:o.masteryLevel-i.masteryLevel};return n.today.sort(r),n.overdue.sort(r),n}function vr(e){const t=at(e),s=e.length>0?e.reduce((r,o)=>r+o.retentionRate,0)/e.length:0,n=[];for(let r=6;r>=0;r--){const o=D().subtract(r,"day"),i=e.filter(a=>a.lastReviewedAt&&D(a.lastReviewedAt).isSame(o,"day")).length;n.push(i)}return{totalItems:e.length,dueToday:t.today.length,overdue:t.overdue.length,mastered:t.mastered.length,streakDays:xr(e),retentionRate:Math.round(s*100),weeklyProgress:n}}function xr(e){if(e.length===0)return 0;let t=0,s=D();for(;e.some(r=>r.lastReviewedAt&&D(r.lastReviewedAt).isSame(s,"day"));)t++,s=s.subtract(1,"day");return t}function qt(e){const t=Date.now();return{id:e.id||`review_${t}_${Math.random().toString(36).substr(2,9)}`,nodeId:e.nodeId||"",nodeName:e.nodeName||"Êú™ÂëΩÂêç",courseId:e.courseId||"",content:e.content||"",type:e.type||"knowledge_point",createdAt:e.createdAt||t,lastReviewedAt:null,nextReviewAt:ps(0),reviewCount:0,difficulty:e.difficulty||"medium",retentionRate:0,masteryLevel:0,isForgotten:!1,tags:e.tags||[]}}function lt(e){const t=_r(e.lastReviewedAt||e.createdAt,e.reviewCount),s=D().diff(D(e.lastReviewedAt||e.createdAt),"day",!0),n=1+e.reviewCount*.5,r=Math.round(-Math.log(.2)*n-s);let o;return t<.3?o="critical":t<.5?o="high":t<yr?o="medium":o="low",{level:o,probability:Math.round((1-t)*100),daysUntilForgotten:Math.max(0,r)}}function Sr(e){return[...e].sort((t,s)=>{const n=lt(t),r=lt(s),o={critical:4,high:3,medium:2,low:1};if(o[n.level]!==o[r.level])return o[r.level]-o[n.level];const i=Date.now()-t.nextReviewAt,a=Date.now()-s.nextReviewAt;return Math.abs(i-a)>36e5?a-i:t.masteryLevel-s.masteryLevel})}const _e="http://localhost:8000",Bt="course-generation-state-v1",Ze=e=>e.replace(/[\\/:*?"<>|]/g,"_").trim(),Fe=(e,t)=>{const s=URL.createObjectURL(e),n=document.createElement("a");n.href=s,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)},gs=_s("course",{state:()=>({courseList:[],currentCourseId:"",courseTree:[],nodes:[],currentNode:null,annotations:[],loading:!1,chatHistory:[],tasks:new Map,globalTasks:[],globalPollingTimer:null,activeTaskId:null,queue:[],isQueueProcessing:!1,isGenerating:!1,generationStatus:"idle",generationLogs:[],currentGeneratingNode:null,currentGeneratingNodeId:null,generationProgress:0,typingBuffer:new Map,typingInterval:null,activeAnnotation:null,scrollToNodeId:null,focusNoteId:null,pendingChatInput:"",userPersona:localStorage.getItem("user_persona")||"",chatLoading:!1,chatAbortController:null,isFocusMode:!1,showKnowledgeGraph:!1,isMobileNotesVisible:!1,globalSearchQuery:"",uiSettings:{fontSize:17,fontFamily:"sans",lineHeight:1.75},notes:[],learningStats:{totalStudyTime:0,dailyStudyTime:{},nodeReadTime:{},lastReadPosition:{},completedNodes:[],streakDays:0,lastStudyDate:null,studyDays:0},wrongAnswers:[],quizHistory:[],stateRestored:!1,learningPath:null,knowledgeMastery:null,learningPathLoading:!1,reviewItems:[],reviewStats:{totalItems:0,dueToday:0,overdue:0,mastered:0,streakDays:0,retentionRate:0,weeklyProgress:[0,0,0,0,0,0,0]},currentReviewSession:null,reviewLoading:!1}),getters:{treeData:e=>e.courseTree,getNotesByNodeId:e=>t=>e.notes.filter(s=>s.nodeId===t),currentCourse:e=>e.courseList.find(t=>t.course_id===e.currentCourseId)},actions:{setUiSettings(e){this.uiSettings={...this.uiSettings,...e}},addNote(e){this.notes.push(e)},updateUserPersona(e){this.userPersona=e,localStorage.setItem("user_persona",e)},recordStudyTime(e,t){const s=D().format("YYYY-MM-DD");this.learningStats.totalStudyTime+=e,this.learningStats.dailyStudyTime[s]||(this.learningStats.dailyStudyTime[s]=0),this.learningStats.dailyStudyTime[s]+=e,t&&(this.learningStats.nodeReadTime[t]||(this.learningStats.nodeReadTime[t]=0),this.learningStats.nodeReadTime[t]+=e);const n=D().format("YYYY-MM-DD"),r=this.learningStats.lastStudyDate;if(r){const o=D(n).diff(D(r),"day");o===1?this.learningStats.streakDays+=1:o>1&&(this.learningStats.streakDays=1)}else this.learningStats.streakDays=1;this.learningStats.lastStudyDate=n,this.persistLearningStats()},saveReadingPosition(e,t,s){this.learningStats.lastReadPosition[e]={nodeId:t,scrollTop:s},this.persistLearningStats()},getReadingPosition(e){return this.learningStats.lastReadPosition[e]||null},markNodeAsCompleted(e){this.learningStats.completedNodes.includes(e)||(this.learningStats.completedNodes.push(e),this.persistLearningStats())},isNodeCompleted(e){return this.learningStats.completedNodes.includes(e)},getNodeReadTime(e){return this.learningStats.nodeReadTime[e]||0},getTodayStudyTime(){const e=D().format("YYYY-MM-DD");return this.learningStats.dailyStudyTime[e]||0},getWeeklyStudyTime(){let e=0;for(let t=0;t<7;t++){const s=D().subtract(t,"day").format("YYYY-MM-DD");e+=this.learningStats.dailyStudyTime[s]||0}return e},persistLearningStats(){try{localStorage.setItem("learning_stats",JSON.stringify(this.learningStats))}catch(e){console.error("Failed to persist learning stats:",e)}},restoreLearningStats(){try{const e=localStorage.getItem("learning_stats");if(e){const t=JSON.parse(e);this.learningStats={...this.learningStats,...t}}}catch(e){console.error("Failed to restore learning stats:",e)}},exportNotesToMarkdown(){const e=this.notes;if(e.length===0)return`# Â≠¶‰π†Á¨îËÆ∞

ÊöÇÊó†Á¨îËÆ∞ÂÜÖÂÆπ„ÄÇ`;let t=`# Â≠¶‰π†Á¨îËÆ∞ÂØºÂá∫

`;t+=`ÂØºÂá∫Êó∂Èó¥Ôºö${D().format("YYYY-MM-DD HH:mm:ss")}

`,t+=`---

`;const s={user:e.filter(n=>n.sourceType==="user"||!n.sourceType),ai:e.filter(n=>n.sourceType==="ai"),wrong:e.filter(n=>n.sourceType==="wrong"),format:e.filter(n=>n.sourceType==="format")};return s.wrong.length>0&&(t+=`## üìù ÈîôÈ¢òËÆ∞ÂΩï

`,s.wrong.forEach((n,r)=>{t+=`### ÈîôÈ¢ò ${r+1}

`,t+=`**Êó∂Èó¥**Ôºö${D(n.createdAt).format("YYYY-MM-DD HH:mm")}

`,n.quote&&(t+=`**È¢òÁõÆ**Ôºö
> ${n.quote}

`),t+=`${n.content}

`,t+=`---

`})),s.ai.length>0&&(t+=`## üí¨ AI ÈóÆÁ≠îËÆ∞ÂΩï

`,s.ai.forEach((n,r)=>{t+=`### ÈóÆÁ≠î ${r+1}

`,t+=`**Êó∂Èó¥**Ôºö${D(n.createdAt).format("YYYY-MM-DD HH:mm")}

`,n.quote&&(t+=`**ÂºïÁî®**Ôºö
> ${n.quote}

`),t+=`${n.content}

`,t+=`---

`})),s.user.length>0&&(t+=`## ‚úèÔ∏è ‰∏™‰∫∫Á¨îËÆ∞

`,s.user.forEach((n,r)=>{t+=`### Á¨îËÆ∞ ${r+1}

`,t+=`**Êó∂Èó¥**Ôºö${D(n.createdAt).format("YYYY-MM-DD HH:mm")}

`,n.quote&&(t+=`**ÂºïÁî®**Ôºö
> ${n.quote}

`),t+=`${n.content}

`,t+=`---

`})),t},exportNotesToJSON(){const e={exportTime:D().format("YYYY-MM-DD HH:mm:ss"),totalNotes:this.notes.length,notes:this.notes.map(t=>({...t,createdAtFormatted:D(t.createdAt).format("YYYY-MM-DD HH:mm:ss")}))};return JSON.stringify(e,null,2)},downloadNotes(e="markdown"){const t=e==="markdown"?this.exportNotesToMarkdown():this.exportNotesToJSON(),s=new Blob([t],{type:"text/plain;charset=utf-8"}),n=`Â≠¶‰π†Á¨îËÆ∞_${D().format("YYYYMMDD")}.${e==="markdown"?"md":"json"}`;Fe(s,n)},persistGenerationState(){try{const e=Array.from(this.tasks.values()).map(n=>({id:n.id,courseName:n.courseName,status:n.status,progress:n.progress,currentStep:n.currentStep,logs:n.logs,nodes:n.nodes,shouldStop:!1})),t=this.queue.map(n=>({...n})),s={version:1,currentCourseId:this.currentCourseId,tasks:e,queue:t};localStorage.setItem(Bt,JSON.stringify(s))}catch(e){console.error(e)}},restoreGenerationState(){if(this.stateRestored)return this.currentCourseId;const e=localStorage.getItem(Bt);if(!e)return null;try{const t=JSON.parse(e),s=new Map;Array.isArray(t.tasks)&&t.tasks.forEach(r=>{s.set(r.id,{...r,shouldStop:!1})});const n=Array.isArray(t.queue)?t.queue.filter(r=>r.status==="completed"||r.status==="error"):[];return this.tasks=s,this.queue=n,this.isQueueProcessing=!1,this.currentCourseId="",this.tasks.forEach(r=>{(r.status==="running"||r.status==="paused")&&!r.backendTaskId&&(r.status="idle",r.currentStep="",this.addLogToTask(r.id,"‚èπÔ∏è Êú™ÂÆåÊàêÁöÑ‰ªªÂä°Â∑≤ÂÅúÊ≠¢"))}),this.stateRestored=!0,null}catch(t){return console.error(t),null}},finalizeIdleTasks(){let e=!1;if(this.tasks.forEach(t=>{const s=this.queue.some(n=>n.courseId===t.id&&(n.status==="pending"||n.status==="running"));if(t.status==="running"&&!s){if(!this.queue.some(r=>r.courseId===t.id&&r.type==="knowledge_graph")){this.addToQueue({courseId:t.id,type:"knowledge_graph",targetNodeId:"root",title:"ÁîüÊàêÁü•ËØÜÂõæË∞±"});return}t.status="completed",t.progress=100,t.currentStep="",this.addLogToTask(t.id,"‚úÖ ÁîüÊàêÂÆåÊàê"),e=!0}}),e){if(this.isGenerating=!1,this.currentCourseId){const t=this.tasks.get(this.currentCourseId);(!t||t.status!=="running")&&(this.generationStatus="idle")}this.persistGenerationState()}},async markNodeAsRead(e){const t=this.nodes.find(s=>s.node_id===e);if(t&&!t.is_read){t.is_read=!0;try{await O.put(`/courses/${this.currentCourseId}/nodes/${e}`,{is_read:!0})}catch(s){console.error("Failed to sync read status",s)}}},async updateNodeScore(e,t){const s=this.nodes.find(n=>n.node_id===e);if(s&&(!s.quiz_score||t>s.quiz_score)){s.quiz_score=t;try{await O.put(`/courses/${this.currentCourseId}/nodes/${e}`,{quiz_score:t})}catch(n){console.error("Failed to sync quiz score",n)}}},async createNote(e){this.addNote(e);try{await this.saveAnnotation({anno_id:e.id,node_id:e.nodeId,question:e.sourceType==="ai"?"AI Assistant Note":"User Note",answer:e.content,anno_summary:e.summary||(e.content.length>50?e.content.slice(0,50)+"...":e.content),quote:e.quote,source_type:e.sourceType||"user"})}catch(t){console.error("Failed to persist note",t)}},async updateNote(e,t){const s=this.notes.find(n=>n.id===e);if(s){s.content=t;try{await O.put(`/annotations/${e}`,{content:t})}catch(n){console.error("Failed to update note persistence",n),x.warning("Á¨îËÆ∞‰øùÂ≠òÂ§±Ë¥•ÔºåËØ∑ÈáçËØï")}}},async deleteNote(e){const t=this.notes.findIndex(s=>s.id===e);if(t!==-1){this.notes.splice(t,1);try{await O.delete(`/annotations/${e}`),this.annotations=this.annotations.filter(s=>s.anno_id!==e)}catch(s){console.error("Failed to delete note persistence",s)}}},async updateNoteTags(e,t){const s=this.notes.find(n=>n.id===e);if(s){s.tags=t;try{await O.put(`/annotations/${e}/tags`,{tags:t})}catch(n){console.error("Failed to update note tags",n)}}},async updateNoteCategory(e,t){const s=this.notes.find(n=>n.id===e);if(s){s.category=t;try{await O.put(`/annotations/${e}/category`,{category:t})}catch(n){console.error("Failed to update note category",n)}}},async updateNotePriority(e,t){const s=this.notes.find(n=>n.id===e);if(s){s.priority=t;try{await O.put(`/annotations/${e}/priority`,{priority:t})}catch(n){console.error("Failed to update note priority",n)}}},getAllTags(){const e=new Set;return this.notes.forEach(t=>{var s;(s=t.tags)==null||s.forEach(n=>e.add(n))}),Array.from(e).sort()},getAllCategories(){const e=new Set;return this.notes.forEach(t=>{t.category&&e.add(t.category)}),Array.from(e).sort()},getNotesByTag(e){return this.notes.filter(t=>{var s;return(s=t.tags)==null?void 0:s.includes(e)})},getNotesByCategory(e){return this.notes.filter(t=>t.category===e)},getNotesByPriority(e){return this.notes.filter(t=>t.priority===e)},createTask(e,t,s,n={}){const r={id:e,courseName:t,status:"idle",progress:0,currentStep:"",logs:[],nodes:JSON.parse(JSON.stringify(s)),shouldStop:!1,difficulty:n.difficulty};return this.tasks.set(e,r),this.persistGenerationState(),r},async createCourse(e){try{const t=await O.post("/generate_course",{keyword:e});if(t.data){const s=t.data.course_id;return await this.fetchCourseList(),s}}catch(t){throw console.error(t),t}},async sendMessage(e){this.chatLoading=!0;try{await this.askQuestion(e)}finally{this.chatLoading=!1}},cancelChat(){this.chatAbortController&&this.chatAbortController.abort()},addMessage(e,t){this.chatHistory.push({type:e,content:t})},scrollToNode(e){this.scrollToNodeId=null,setTimeout(()=>{this.scrollToNodeId=e},10)},scrollToNote(e){this.focusNoteId=null,setTimeout(()=>{this.focusNoteId=e},10)},setPendingChatInput(e){this.pendingChatInput=e},async fetchGlobalTasks(){try{const e=await O.get("/tasks?limit=100");this.globalTasks=e.data,this.globalTasks.forEach(t=>{const s=t.course_id;let n=this.tasks.get(s);n&&(t.status==="running"?n.status="running":t.status==="paused"?n.status="paused":t.status==="completed"?n.status="completed":t.status==="error"?n.status="error":t.status==="pending"&&(n.status="pending"),n.progress=t.progress,n.backendTaskId=t.id,t.current_node_name&&(n.currentStep=`Ê≠£Âú®ÁîüÊàê: ${t.current_node_name}`),s===this.currentCourseId&&t.status==="running"&&Math.random()<.2&&this.refreshCourseData(s))})}catch(e){console.error("Failed to fetch global tasks",e)}},startGlobalMonitor(){this.globalPollingTimer||(this.fetchGlobalTasks(),this.globalPollingTimer=setInterval(()=>{this.fetchGlobalTasks()},2e3))},stopGlobalMonitor(){this.globalPollingTimer&&(clearInterval(this.globalPollingTimer),this.globalPollingTimer=null)},async startBackendTask(e){try{const t=await O.post(`/courses/${e}/auto_generate`),{task_id:s}=t.data;let n=this.tasks.get(e);if(!n){const r=this.courseList.find(o=>o.course_id===e);n=this.createTask(e,(r==null?void 0:r.course_name)||"Unknown Course",[])}n.backendTaskId=s,n.status="running",n.shouldStop=!1,this.addLogToTask(e,`üöÄ ÂêéÂè∞‰ªªÂä°Â∑≤ÂêØÂä® (ID: ${s})`),this.persistGenerationState(),this.startGlobalMonitor()}catch(t){console.error("Failed to start backend task",t),x.error("ÂêØÂä®ÂêéÂè∞ÁîüÊàêÂ§±Ë¥•")}},async pauseBackendTask(e){const t=this.tasks.get(e);if(!(!t||!t.backendTaskId))try{await O.post(`/tasks/${t.backendTaskId}/pause`),t.status="paused",this.addLogToTask(e,"‚è∏Ô∏è ÂêéÂè∞‰ªªÂä°Â∑≤ÊöÇÂÅú")}catch(s){console.error("Failed to pause task",s)}},async resumeBackendTask(e){const t=this.tasks.get(e);if(!(!t||!t.backendTaskId))try{await O.post(`/tasks/${t.backendTaskId}/resume`),t.status="running",this.addLogToTask(e,"‚ñ∂Ô∏è ÂêéÂè∞‰ªªÂä°Â∑≤ÊÅ¢Â§ç"),this.startGlobalMonitor()}catch(s){console.error("Failed to resume task",s)}},async refreshCourseData(e){if(this.currentCourseId===e)try{const t=await O.get(`/courses/${e}`);t.data&&t.data.nodes&&(this.nodes=t.data.nodes,this.courseTree=this.buildTree(this.nodes))}catch(t){console.error("Failed to refresh course data",t)}},getTask(e){return this.tasks.get(e)},pauseTask(e){const t=this.tasks.get(e);if(t){if(t.backendTaskId){this.pauseBackendTask(e);return}t.status="paused",t.shouldStop=!0,this.addLogToTask(e,"‚è∏Ô∏è ‰ªªÂä°Â∑≤ÊöÇÂÅú"),this.persistGenerationState()}},startTask(e){const t=this.tasks.get(e);if(t){if(t.backendTaskId){this.resumeBackendTask(e);return}this.startBackendTask(e)}},clearChat(){this.chatHistory=[],this.activeAnnotation=null},async generateQuiz(e,t,s="standard",n="medium",r={}){var a,d;this.chatLoading=!0;const o=r.silent===!0,i=r.questionCount||3;o||this.chatHistory.push({type:"user",content:`ËØ∑‰∏∫"${((a=this.nodes.find(l=>l.node_id===e))==null?void 0:a.node_name)||"ÂΩìÂâçÁ´†ËäÇ"}"ÁîüÊàê‰∏Ä‰ªΩ${n==="hard"?"Âõ∞Èöæ":n==="easy"?"ÁÆÄÂçï":"‰∏≠Á≠â"}ÈöæÂ∫¶ÁöÑ${s==="creative"?"ÂàõÊÑè":s==="practical"?"ÂÆûÊàò":"Ê†áÂáÜ"}ÊµãËØïÈ¢òÔºàÂÖ±${i}È¢òÔºâ„ÄÇ`});try{const l=await O.post(`/courses/${this.currentCourseId}/nodes/${e}/quiz`,{node_content:t,node_name:((d=this.nodes.find(f=>f.node_id===e))==null?void 0:d.node_name)||"",difficulty:n,style:s,user_persona:this.userPersona,question_count:i}),u=Array.isArray(l.data)?l.data.map(f=>({...f,answer:f.answer||(typeof f.correct_index=="number"&&f.options?f.options[f.correct_index]:""),node_id:e})):[];if(Array.isArray(l.data)){if(l.data.length===0)o||this.chatHistory.push({type:"ai",content:"Êä±Ê≠âÔºåÊó†Ê≥ïÊ†πÊçÆÂΩìÂâçÂÜÖÂÆπÁîüÊàêÊµãËØïÈ¢ò„ÄÇ"});else if(!o){const f=`### üìù ${s==="creative"?"ÂàõÊÑèÊåëÊàò":s==="practical"?"ÂÆûÊàòÊºîÁªÉ":"Áü•ËØÜÊµãÈ™å"}
ËøôÈáåÊúâÂá†ÈÅìÈ¢òÁõÆÊù•Ê£ÄÊµã‰Ω†ÁöÑÂ≠¶‰π†ÊàêÊûúÔºö`;this.chatHistory.push({type:"ai",content:{core_answer:f,answer:f,quiz_list:u}})}}return u}catch{return x.error("ÁîüÊàêÊµãÈ™åÂ§±Ë¥•"),o||this.chatHistory.push({type:"ai",content:"ÁîüÊàêÊµãÈ™åÊó∂ÈÅáÂà∞ÈîôËØØÔºåËØ∑Á®çÂêéÂÜçËØï„ÄÇ"}),[]}finally{this.chatLoading=!1}},recordWrongAnswer(e){const t=this.wrongAnswers.findIndex(s=>s.question===e.question&&s.nodeId===e.nodeId);if(t>=0){const s=this.wrongAnswers[t];s&&(s.reviewCount+=1,s.timestamp=Date.now())}else this.wrongAnswers.push({...e,timestamp:Date.now(),reviewCount:1});this.persistQuizData()},recordQuizResult(e,t,s,n){this.quizHistory.push({nodeId:e,nodeName:t,totalQuestions:s,correctCount:n,timestamp:Date.now()}),this.persistQuizData()},persistQuizData(){try{localStorage.setItem("quiz_wrong_answers",JSON.stringify(this.wrongAnswers)),localStorage.setItem("quiz_history",JSON.stringify(this.quizHistory))}catch(e){console.error("Failed to persist quiz data:",e)}},restoreQuizData(){try{const e=localStorage.getItem("quiz_wrong_answers"),t=localStorage.getItem("quiz_history");e&&(this.wrongAnswers=JSON.parse(e)),t&&(this.quizHistory=JSON.parse(t))}catch(e){console.error("Failed to restore quiz data:",e)}},getWrongAnswersForReview(e=10){return this.wrongAnswers.sort((t,s)=>t.reviewCount!==s.reviewCount?t.reviewCount-s.reviewCount:t.timestamp-s.timestamp).slice(0,e)},markWrongAnswerReviewed(e,t,s=!1){const n=this.wrongAnswers.findIndex(r=>r.question===e&&r.nodeId===t);if(n>=0){const r=this.wrongAnswers[n];s?this.wrongAnswers.splice(n,1):r&&(r.reviewCount+=1,r.timestamp=Date.now()),this.persistQuizData()}},async generateSmartQuizFromMistakes(){const e=this.getWrongAnswersForReview(5);if(e.length===0)return x.info("ÊöÇÊó†ÈúÄË¶ÅÂ§ç‰π†ÁöÑÈîôÈ¢ò"),[];const t=`### üîÑ ÈîôÈ¢òÂõûÈ°æ
Ê†πÊçÆ‰Ω†‰πãÂâçÁöÑÈîôÈ¢òÔºåÊàë‰ª¨Á≤æÈÄâ‰∫Ü‰∏Ä‰∫õÈ¢òÁõÆÂ∏ÆÂä©‰Ω†Â∑©Âõ∫Ôºö`;return this.chatHistory.push({type:"ai",content:{core_answer:t,answer:t,quiz_list:e.map(s=>({question:s.question,options:s.options,correct_index:s.correctIndex,explanation:s.explanation,node_id:s.nodeId,isReview:!0}))}}),e},getQuizStats(){const e=this.quizHistory.length,t=this.quizHistory.reduce((r,o)=>r+o.totalQuestions,0),s=this.quizHistory.reduce((r,o)=>r+o.correctCount,0),n=t>0?Math.round(s/t*100):0;return{totalQuizzes:e,totalQuestions:t,totalCorrect:s,accuracy:n,wrongAnswerCount:this.wrongAnswers.length}},startTypingEffect(){this.typingInterval||(this.typingInterval=setInterval(()=>{let e=!1;this.typingBuffer.forEach((t,s)=>{if(t.length>0){e=!0;let n=1;t.length>500?n=50:t.length>200?n=20:t.length>50?n=5:t.length>10&&(n=2);const r=t.slice(0,n);this.typingBuffer.set(s,t.slice(n));const o=this.nodes.find(i=>i.node_id===s);o&&(o.node_content=(o.node_content||"")+r)}else this.typingBuffer.delete(s)}),!this.isGenerating&&!e&&this.typingInterval!==null&&(clearInterval(this.typingInterval),this.typingInterval=null)},10))},addToBuffer(e,t){const s=this.typingBuffer.get(e)||"";this.typingBuffer.set(e,s+t),this.startTypingEffect()},stopGeneration(){this.currentCourseId&&this.pauseTask(this.currentCourseId),this.isGenerating=!1,this.generationStatus="paused",this.typingBuffer.clear(),this.typingInterval&&(clearInterval(this.typingInterval),this.typingInterval=null),x.info("ÁîüÊàêÂ∑≤ÊöÇÂÅú"),this.persistGenerationState()},async startSmartGeneration(e,t={}){this.loading=!0,this.isGenerating=!0,this.generationStatus="generating",this.generationProgress=0,this.generationLogs=[],this.addLog(`üöÄ ÂêØÂä®Êô∫ËÉΩËØæÁ®ãÁîüÊàêÂºïÊìé: ${e}`);try{this.addLog("üèóÔ∏è Ê≠£Âú®ÊûÑÂª∫ËØæÁ®ãÂ§ßÁ∫≤Êû∂ÊûÑ...");const s=await O.post("/generate_course",{keyword:e,...t});if(s.data&&s.data.nodes){const n=s.data.course_id,r=s.data.course_name,o=this.createTask(n,r,s.data.nodes,t);o.status="running",this.currentCourseId=n,this.nodes=s.data.nodes,this.courseTree=this.buildTree(this.nodes),await this.fetchCourseList(),this.addLog(`‚úÖ Â§ßÁ∫≤Êû∂ÊûÑÊûÑÂª∫ÂÆåÊàêÔºåÂåÖÂê´ ${this.nodes.length} ‰∏™ËäÇÁÇπ`),this.persistGenerationState(),await this.startBackendTask(n)}}catch(s){this.addLog(`‚ùå ÁîüÊàêÂ§±Ë¥•: ${s}`),x.error("ÁîüÊàêÂ§±Ë¥•"),this.isGenerating=!1,this.generationStatus="error",this.persistGenerationState()}finally{this.loading=!1}},async fetchCourseList(){this.loading=!0;try{const e=await O.get("/courses");this.courseList=e.data}catch(e){console.error(e),this.courseList=[]}finally{this.loading=!1}},async loadCourse(e){this.loading=!0,this.currentCourseId=e,this.notes=[],this.fetchCourseAnnotations(e);try{try{const s=await O.get(`/courses/${e}/task`);if(s.data&&s.data.status!=="none"&&s.data.status!=="error"){const n=s.data;let r=this.tasks.get(e);r||(r=this.createTask(e,"Loading...",[])),r.backendTaskId=n.id,r.status=n.status,r.progress=n.progress,(n.status==="running"||n.status==="pending")&&this.startGlobalMonitor()}}catch{}const t=await O.get(`/courses/${e}`);if(t.data&&t.data.nodes){this.nodes=t.data.nodes,this.courseTree=this.buildTree(this.nodes);const s=this.tasks.get(e);s&&s.courseName==="Loading..."&&(s.courseName=t.data.course_name),s&&s.status!=="running"&&(s.nodes=JSON.parse(JSON.stringify(this.nodes))),s&&s.status==="running"?(this.isGenerating=!0,this.generationProgress=s.progress,this.currentGeneratingNode=s.currentStep,this.generationLogs=s.logs):(this.isGenerating=!1,this.generationProgress=s?s.progress:100,this.generationLogs=s?s.logs:[]);const n=this.getReadingPosition(e);n&&(this.scrollToNodeId=n.nodeId)}else throw new Error("ËØæÁ®ãÊï∞ÊçÆ‰∏∫Á©∫")}catch(t){console.error(t),x.error("Âä†ËΩΩËØæÁ®ãÂ§±Ë¥•"),this.currentCourseId="",this.currentNode=null,this.nodes=[],this.courseTree=[],this.isGenerating=!1,this.generationStatus="idle",this.generationProgress=0}finally{this.loading=!1}},async deleteCourse(e){try{await O.delete(`/courses/${e}`),x.success("ËØæÁ®ãÂ∑≤Âà†Èô§"),this.tasks.delete(e),await this.fetchCourseList(),this.currentCourseId===e&&(this.nodes=[],this.courseTree=[],this.currentCourseId="",this.currentNode=null),this.queue=this.queue.filter(t=>t.courseId!==e),this.persistGenerationState()}catch{x.error("Âà†Èô§Â§±Ë¥•")}},async fetchCourseTree(){await this.fetchCourseList(),this.courseList.length>0&&this.courseList[0]&&await this.loadCourse(this.courseList[0].course_id)},buildTree(e){const t=new Map,s=[],n=e;return n.forEach(r=>{r.children=[],t.set(r.node_id,r)}),n.forEach(r=>{var o;if(r.parent_node_id==="root")s.push(r);else{const i=t.get(r.parent_node_id);i&&((o=i.children)==null||o.push(r))}}),s},addLog(e){if(this.currentCourseId){const t=this.tasks.get(this.currentCourseId);t&&t.logs.push(`[${new Date().toLocaleTimeString()}] ${e}`)}this.generationLogs.push(`[${new Date().toLocaleTimeString()}] ${e}`)},addLogToTask(e,t){const s=this.tasks.get(e);s&&s.logs.push(`[${new Date().toLocaleTimeString()}] ${t}`),this.currentCourseId===e&&this.generationLogs.push(`[${new Date().toLocaleTimeString()}] ${t}`)},async generateCourse(e,t={}){await this.startSmartGeneration(e,t)},getLinearNodes(e){const t=e||this.courseTree;let s=[];for(const n of t)s.push(n),n.children&&n.children.length>0&&s.push(...this.getLinearNodes(n.children));return s},exportCourseJson(){const e=this.courseList.find(o=>o.course_id===this.currentCourseId),t=new Set(this.getLinearNodes(this.courseTree).map(o=>o.node_id)),s=this.notes.filter(o=>t.has(o.nodeId)&&o.sourceType!=="format");if(!e&&this.nodes.length===0&&s.length===0){x.warning("ÂΩìÂâçÊ≤°ÊúâÂèØÂØºÂá∫ÁöÑÂÜÖÂÆπ");return}const n=JSON.stringify({exportedAt:D().format("YYYY-MM-DD HH:mm:ss"),course:e||null,nodes:this.nodes,courseTree:this.courseTree,notes:s},null,2),r=`${Ze((e==null?void 0:e.course_name)||"course")}_export_${D().format("YYYYMMDD_HHmmss")}.json`;Fe(new Blob([n],{type:"application/json"}),r),x.success("ÂØºÂá∫ÊàêÂäü")},exportCourseMarkdown(){const e=this.courseList.find(l=>l.course_id===this.currentCourseId),t=this.getLinearNodes(this.courseTree),s=new Set(t.map(l=>l.node_id)),n=this.notes.filter(l=>s.has(l.nodeId));if(!e&&this.nodes.length===0&&n.length===0){x.warning("ÂΩìÂâçÊ≤°ÊúâÂèØÂØºÂá∫ÁöÑÂÜÖÂÆπ");return}const r=(e==null?void 0:e.course_name)||"My Course";let o=`# ${r}

`;o+=`> ÂØºÂá∫Êó∂Èó¥Ôºö${D().format("YYYY-MM-DD HH:mm")}

`,o+=`> ËäÇÁÇπÊï∞Ôºö${this.nodes.length}

`,o+=`> Á¨îËÆ∞Êï∞Ôºö${n.filter(l=>l.sourceType!=="format").length}

---

`;const i=new Map,a=new Map(t.map((l,u)=>[l.node_id,u]));n.sort((l,u)=>{const f=a.get(l.nodeId)??-1,b=a.get(u.nodeId)??-1;return f!==b?f-b:l.createdAt-u.createdAt}),n.forEach(l=>{var f;const u=l.nodeId;i.has(u)||i.set(u,[]),(f=i.get(u))==null||f.push(l)}),t.forEach(l=>{var b;const u=Math.min(4,Math.max(1,Number(l.node_level||1)));o+=`${"#".repeat(u)} ${l.node_name}

`,l.node_content&&(o+=`${l.node_content}

`);const f=((b=i.get(l.node_id))==null?void 0:b.filter(I=>I.sourceType!=="format"))||[];f.length>0&&(o+=`**Á¨îËÆ∞**

`,f.forEach(I=>{I.quote&&(o+=`> ${I.quote}

`),o+=`${I.content}

`;const g=I.sourceType==="ai"?"AI Âä©Êâã":"Á¨îËÆ∞";o+=`> ‚Äî *${g} ¬∑ ${D(I.createdAt).format("YYYY-MM-DD HH:mm")}*

`}),o+=`---

`)});const d=`${Ze(r)}_export_${D().format("YYYYMMDD_HHmmss")}.md`;Fe(new Blob([o],{type:"text/markdown"}),d),x.success("ÂØºÂá∫ÊàêÂäü")},exportNotesMarkdown(e,t){var l;if(!e||e.length===0){x.warning("ÂΩìÂâçÊ≤°ÊúâÂèØÂØºÂá∫ÁöÑÁ¨îËÆ∞");return}const s=((l=this.courseList.find(u=>u.course_id===this.currentCourseId))==null?void 0:l.course_name)||"My Notes";let n=`# ${s}

`;n+=`> ÂØºÂá∫Êó∂Èó¥Ôºö${D().format("YYYY-MM-DD HH:mm")}

`,n+=`> Á±ªÂûãÔºö${t.filterLabel}

`,t.query&&(n+=`> ÊêúÁ¥¢Ôºö${t.query}

`),n+=`> Êù°ÁõÆÊï∞Ôºö${e.length}

---

`;const r=this.getLinearNodes(this.courseTree),o=new Map(r.map((u,f)=>[u.node_id,f])),i=new Map(r.map(u=>[u.node_id,u.node_name]));e.sort((u,f)=>{const b=o.get(u.nodeId)??-1,I=o.get(f.nodeId)??-1;return b!==I?b-I:u.createdAt-f.createdAt});const a=new Map;e.forEach(u=>{var b;const f=u.nodeId;a.has(f)||a.set(f,[]),(b=a.get(f))==null||b.push(u)}),a.forEach((u,f)=>{n+=`## ${i.get(f)||"Êú™Áü•Á´†ËäÇ"}

`,u.forEach(b=>{b.quote&&(n+=`> ${b.quote}

`),n+=`${b.content}

`;const I=b.sourceType==="ai"?"AI Âä©Êâã":"Á¨îËÆ∞";n+=`> ‚Äî *${I} ¬∑ ${D(b.createdAt).format("YYYY-MM-DD HH:mm")}*

---

`})});const d=`${Ze(s)}_${t.filterLabel}_${D().format("YYYYMMDD_HHmmss")}.md`;Fe(new Blob([n],{type:"text/markdown"}),d),x.success("Markdown ÂØºÂá∫ÊàêÂäü")},addToQueue(e){if(this.queue.some(n=>n.courseId===e.courseId&&n.type===e.type&&n.targetNodeId===e.targetNodeId&&(n.status==="pending"||n.status==="running")))return;const s={...e,uuid:crypto.randomUUID(),status:"pending"};this.queue.push(s),this.persistGenerationState(),this.processQueue()},retryQueueItem(e){const t=this.queue.find(s=>s.uuid===e);t&&t.status==="error"&&(t.status="pending",t.retryCount=0,t.errorMsg=void 0,this.addLogToTask(t.courseId,`üîÑ ÊâãÂä®ÈáçËØï: ${t.title}`),this.persistGenerationState(),this.processQueue())},async processQueue(){if(this.isQueueProcessing)return;const e=this.queue.find(s=>{if(s.status!=="pending")return!1;const n=this.tasks.get(s.courseId);return n&&n.status==="running"&&!n.shouldStop});if(!e){this.isQueueProcessing=!1,this.finalizeIdleTasks(),this.persistGenerationState();return}this.isQueueProcessing=!0,e.status="running",this.persistGenerationState();const t=this.tasks.get(e.courseId);try{if(t&&(t.status="running",t.currentStep=e.title,this.currentCourseId===e.courseId&&(this.currentGeneratingNodeId=e.targetNodeId,this.currentGeneratingNode=t.currentStep,this.isGenerating=!0,this.generationStatus="generating")),e.type==="structure"?await this.processStructureItem(e):e.type==="content"?await this.processContentItem(e):e.type==="subchapter"?await this.processSubchapterItem(e):e.type==="knowledge_graph"&&await this.processKnowledgeGraphItem(e),e.status="completed",t){t.logs.push(`‚úÖ ÂÆåÊàê: ${e.title}`);const s=this.queue.length,n=this.queue.filter(r=>r.status==="completed"||r.status==="error").length;t.progress=Math.floor(n/s*100)}this.persistGenerationState()}catch(s){const n=s instanceof Error?s.message:String(s),r=2;if(e.retryCount=(e.retryCount||0)+1,e.retryCount<=r)e.status="pending",t&&t.logs.push(`‚ö†Ô∏è ‰ªªÂä°Â§±Ë¥• (Â∞ùËØï ${e.retryCount}/${r}): ${e.title} - ${n}ÔºåÂáÜÂ§áÈáçËØï...`);else if(e.status="error",e.errorMsg=n,t){t.logs.push(`‚ùå Â§±Ë¥•: ${e.title} - ${n}`);const o=this.queue.length,i=this.queue.filter(a=>a.status==="completed"||a.status==="error").length;t.progress=Math.floor(i/o*100)}this.persistGenerationState()}finally{t&&t.shouldStop?(this.isQueueProcessing=!1,t.status="paused"):(this.isQueueProcessing=!1,setTimeout(()=>this.processQueue(),50)),this.persistGenerationState()}},async processStructureItem(e){const t=this.tasks.get(e.courseId);if(!t)throw new Error("Task not found");const s=t.nodes.find(o=>o.node_id===e.targetNodeId);if(!s)throw new Error("Node not found");this.addLogToTask(e.courseId,`üìÇ Ê≠£Âú®ÊûÑÂª∫: ${s.node_name}...`);const r=(await O.post(`/courses/${e.courseId}/nodes/${s.node_id}/subnodes`,{node_id:s.node_id,node_name:s.node_name,node_level:s.node_level})).data;if(Array.isArray(r)){t.nodes.push(...r);const o=t.difficulty||"expert";for(const i of r)Number(i.node_level)===2?o==="beginner"||o==="intermediate"?this.addToQueue({courseId:e.courseId,type:"content",targetNodeId:i.node_id,title:`Êí∞ÂÜôÊ≠£Êñá: ${i.node_name}`}):this.addToQueue({courseId:e.courseId,type:"structure",targetNodeId:i.node_id,title:`ÁªÜÂåñÂ∞èËäÇ: ${i.node_name}`}):this.addToQueue({courseId:e.courseId,type:"content",targetNodeId:i.node_id,title:`Êí∞ÂÜôÊ≠£Êñá: ${i.node_name}`});this.currentCourseId===e.courseId&&(this.nodes=[...t.nodes],this.courseTree=this.buildTree(this.nodes))}},async processContentItem(e){var d;const t=this.tasks.get(e.courseId);if(!t)throw new Error("Task not found");const s=t.nodes.find(l=>l.node_id===e.targetNodeId);if(!s)throw new Error("Node not found");this.addLogToTask(e.courseId,`üìù Ê≠£Âú®Êí∞ÂÜô: ${s.node_name}...`);const n=t.nodes.filter(l=>l.node_level<=2).map(l=>`${"  ".repeat(l.node_level-1)}- ${l.node_name}`).join(`
`),r=t.nodes.findIndex(l=>l.node_id===s.node_id);let o="Áõ∏ÂÖ≥‰∏ä‰∏ãÊñá...";if(r>0){const l=t.nodes[r-1];l&&l.node_content&&(o=`‰∏äËäÇ (${l.node_name}) ÂõûÈ°æ: `+l.node_content.slice(-300))}s.node_content="",s.node_type="custom";const a=(d=(await fetch(`${_e}/courses/${e.courseId}/nodes/${s.node_id}/redefine_stream`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({node_id:s.node_id,node_name:s.node_name,original_content:"",user_requirement:"ËØ¶ÁªÜÊ≠£Êñá",course_context:n,previous_context:o})})).body)==null?void 0:d.getReader();if(a){const l=new TextDecoder;for(;;){if(t.shouldStop){a.cancel();break}const{done:u,value:f}=await a.read();if(u)break;const b=l.decode(f,{stream:!0});s.node_content=(s.node_content||"")+b,this.currentCourseId===e.courseId&&this.addToBuffer(s.node_id,b)}}},async processSubchapterItem(e){const t=this.tasks.get(e.courseId);if(!t)throw new Error("Task not found");if(t.shouldStop)return;const s=t.nodes.find(a=>a.node_id===e.targetNodeId);if(!s)throw new Error("Node not found");const n=s.node_content||"",r=[],o=/^(#{1,6})\s+(.*)$/gm;let i;for(;(i=o.exec(n))!==null;)i[2]&&r.push(i[2].trim());if(r.length>0){this.addLogToTask(e.courseId,`üîç ÊèêÂèñÂà∞ ${r.length} ‰∏™Ê†áÈ¢òÔºåÊ≠£Âú®ÁîüÊàê...`);for(const a of r)try{const d=await O.post(`/courses/${e.courseId}/nodes`,{parent_node_id:s.node_id,node_name:a,node_level:s.node_level+1,node_content:""});t.nodes.push(d.data),this.addToQueue({courseId:e.courseId,type:"content",targetNodeId:d.data.node_id,title:`Êí∞ÂÜôÊ≠£Êñá: ${d.data.node_name}`})}catch(d){console.error("Manual create failed, trying fallback",d)}}else{this.addLogToTask(e.courseId,"ü§ñ Êô∫ËÉΩÁîüÊàêÂ≠êÁ´†ËäÇ...");const d=(await O.post(`/courses/${e.courseId}/nodes/${s.node_id}/subnodes`,{node_id:s.node_id,node_name:s.node_name,node_level:s.node_level})).data;t.nodes.push(...d);for(const l of d)this.addToQueue({courseId:e.courseId,type:"content",targetNodeId:l.node_id,title:`Êí∞ÂÜôÊ≠£Êñá: ${l.node_name}`})}this.currentCourseId===e.courseId&&(this.nodes=[...t.nodes],this.courseTree=this.buildTree(this.nodes))},async processKnowledgeGraphItem(e){this.addLogToTask(e.courseId,"üï∏Ô∏è Ê≠£Âú®ÁîüÊàêÁü•ËØÜÂõæË∞±...");try{await O.post(`/courses/${e.courseId}/knowledge_graph`),this.addLogToTask(e.courseId,"‚úÖ Áü•ËØÜÂõæË∞±ÁîüÊàêÂÆåÊàê"),this.currentCourseId,e.courseId}catch(t){throw console.error("Failed to generate knowledge graph",t),t}},async generateSubChapters(e){this.currentCourseId&&this.addToQueue({courseId:this.currentCourseId,type:"subchapter",targetNodeId:e.node_id,title:`ÁîüÊàêÂ≠êÁ´†ËäÇ: ${e.node_name}`})},async generateFullDetails(e){const t=e||this.currentCourseId;if(!t)return;const s=this.tasks.get(t);if(!s)return;s.status="running",s.shouldStop=!1,t===this.currentCourseId&&(this.generationStatus="generating");const n=s.nodes.filter(a=>a.node_level===1);for(const a of n)s.nodes.some(l=>l.parent_node_id===a.node_id)||this.addToQueue({courseId:t,type:"structure",targetNodeId:a.node_id,title:`ÊûÑÂª∫Á´†ËäÇ: ${a.node_name}`});const r=s.nodes.filter(a=>a.node_level===2),o=s.difficulty||"expert";for(const a of r)s.nodes.some(l=>l.parent_node_id===a.node_id)||(o==="beginner"||o==="intermediate"?this.addToQueue({courseId:t,type:"content",targetNodeId:a.node_id,title:`Êí∞ÂÜôÊ≠£Êñá: ${a.node_name}`}):this.addToQueue({courseId:t,type:"structure",targetNodeId:a.node_id,title:`ÁªÜÂåñÂ∞èËäÇ: ${a.node_name}`}));const i=s.nodes.filter(a=>a.node_level===3&&(!a.node_content||a.node_content.length<50));for(const a of i)this.addToQueue({courseId:t,type:"content",targetNodeId:a.node_id,title:`Êí∞ÂÜôÊ≠£Êñá: ${a.node_name}`})},async generateNodeContent(e){var s;if(!this.currentCourseId)return;const t=this.nodes.find(n=>n.node_id===e);if(t){this.isGenerating=!0,this.currentGeneratingNode=`Ê≠£Âú®ÁîüÊàê: ${t.node_name}`,this.currentGeneratingNodeId=e,this.addLog(`üöÄ ÂºÄÂßãÁîüÊàêÁ´†ËäÇ: ${t.node_name}`),t.node_content="",t.node_type="custom";try{const n=this.nodes.filter(I=>I.node_level<=2).map(I=>`${"  ".repeat(I.node_level-1)}- ${I.node_name}`).join(`
`),r=this.getLinearNodes(this.courseTree),o=r.findIndex(I=>I.node_id===e);let i="Áõ∏ÂÖ≥ËÉåÊôØ...";if(o>0){const I=r[o-1];I&&I.node_content&&(i=`‰∏äËäÇÂõûÈ°æ (${I.node_name}): `+I.node_content.slice(-500))}const a=this.tasks.get(this.currentCourseId),d=(a==null?void 0:a.difficulty)||"expert",l=(a==null?void 0:a.style)||"academic";let u="ÊïôÁßë‰π¶Á∫ßËØ¶ÁªÜÊ≠£Êñá";d==="beginner"?u="ÈÄö‰øóÊòìÊáÇÁöÑÂü∫Á°ÄÂÖ•Èó®ÊïôÁ®ãÔºåÈáçÁÇπËß£ÈáäÊ†∏ÂøÉÊ¶ÇÂøµÔºåÂ§öÁî®ÁîüÊ¥ªÊ°à‰æãÁ±ªÊØîÔºåÈÅøÂÖçËøá‰∫éÊ∑±Â••ÁöÑÁêÜËÆ∫Êé®ÂØº„ÄÇÂÜÖÂÆπË¶ÅÂÅèÂü∫Á°ÄÔºåÈÄÇÂêàÂàùÂ≠¶ËÄÖ„ÄÇ":d==="intermediate"?u="Ê†áÂáÜ‰∏ì‰∏öÊïôÁ®ãÔºåÁêÜËÆ∫‰∏éÂÆûË∑µÁõ∏ÁªìÂêàÔºåÂåÖÂê´‰ª£Á†ÅÁ§∫‰æãÊàñÂ∫îÁî®Âú∫ÊôØ„ÄÇ‰∏çÊ∂âÂèäËøáÊ∑±ÁöÑÂ∫ïÂ±ÇÂéüÁêÜÔºå‰ΩÜË¶ÅË¶ÜÁõñÊ†∏ÂøÉÁî®Ê≥ï„ÄÇ":u="Ê∑±Â∫¶‰∏ì‰∏öÁöÑÊäÄÊúØÊñáÊ°£ÔºåÂåÖÂê´Â∫ïÂ±ÇÂéüÁêÜ„ÄÅÊ∫êÁ†ÅÂàÜÊûê„ÄÅÊÄßËÉΩ‰ºòÂåñÂíåÈ´òÁ∫ßÊúÄ‰Ω≥ÂÆûË∑µ„ÄÇÈÄÇÂêà‰∏ìÂÆ∂ÈòÖËØª„ÄÇ";const b=(s=(await fetch(`${_e}/courses/${this.currentCourseId}/nodes/${e}/redefine_stream`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({node_id:t.node_id,node_name:t.node_name,original_content:t.node_content||"",user_requirement:u,course_context:n,previous_context:i,difficulty:d,style:l})})).body)==null?void 0:s.getReader();if(b){const I=new TextDecoder;for(;;){const{done:g,value:S}=await b.read();if(g)break;const w=I.decode(S,{stream:!0});this.addToBuffer(t.node_id,w)}}this.addLog(`‚úÖ Á´†ËäÇÁîüÊàêÂÆåÊàê: ${t.node_name}`),x.success("Á´†ËäÇÁîüÊàêÂÆåÊàê")}catch(n){this.addLog(`‚ùå ÁîüÊàêÂ§±Ë¥•: ${n}`),x.error("ÁîüÊàêÂ§±Ë¥•")}finally{this.isGenerating=!1,this.currentGeneratingNode=null,this.currentGeneratingNodeId=null}}},selectNode(e){this.currentNode=e},setCurrentNodeSilent(e){this.currentNode=e},setCurrentNode(e){const t=this.courseTree.find(s=>s.node_id===e);t&&(this.currentNode=t)},async fetchAnnotations(e){try{const s=(await O.get(`/nodes/${e}/annotations`)).data,n=new Set(this.annotations.map(r=>r.anno_id));s.forEach(r=>{n.has(r.anno_id)||this.annotations.push(r)})}catch(t){console.error(t)}},async fetchCourseAnnotations(e){try{const t=await O.get(`/courses/${e}/annotations`);this.annotations=t.data,t.data.forEach(n=>{this.notes.find(r=>r.id===n.anno_id)||this.notes.push({id:n.anno_id,nodeId:n.node_id,highlightId:`hl-${n.anno_id}`,quote:n.quote||"",content:n.answer||n.question||"",summary:n.anno_summary||"",color:"amber",createdAt:Date.now(),sourceType:n.source_type||"user"})})}catch(t){console.error("Failed to load annotations",t)}},async saveAnnotation(e){if(e.anno_id&&this.annotations.find(s=>s.anno_id===e.anno_id)){x.warning("ËØ•Á¨îËÆ∞Â∑≤Â≠òÂú®");return}const t={anno_id:e.anno_id||`anno_${crypto.randomUUID()}`,node_id:e.node_id,course_id:this.currentCourseId,question:e.question||"User Note",answer:e.answer||"",anno_summary:e.anno_summary||"Note",source_type:e.source_type||"user_saved",quote:e.quote};try{t.source_type!=="format"&&await O.post("/annotations",t),this.annotations.push(t),t.source_type!=="format"&&x.success("Á¨îËÆ∞Â∑≤‰øùÂ≠ò"),this.activeAnnotation=t}catch(s){x.error("‰øùÂ≠òÂ§±Ë¥•"),console.error(s)}},async deleteAnnotation(e){var t;try{await O.delete(`/annotations/${e}`),this.annotations=this.annotations.filter(s=>s.anno_id!==e),x.success("Á¨îËÆ∞Â∑≤Âà†Èô§"),((t=this.activeAnnotation)==null?void 0:t.anno_id)===e&&(this.activeAnnotation=null)}catch{x.error("Âà†Èô§Â§±Ë¥•")}},async askQuestion(e,t="",s){var i,a;let n=null,r=null,o=this.currentNode;if(s){const d=this.nodes.find(l=>l.node_id===s);d&&(o=d)}if(!o&&this.nodes.length>0&&(o=this.nodes[0]||null),!o){x.warning("ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∏™ËØæÁ®ãÊàñÁ´†ËäÇ");return}this.loading=!0,this.chatLoading=!0;try{this.chatAbortController&&this.chatAbortController.abort(),n=new AbortController,this.chatAbortController=n;const d=this.getLinearNodes(this.courseTree),l=d.map(R=>`${"  ".repeat(R.node_level-1)}- ${R.node_name} (ID: ${R.node_id})`).join(`
`);let u="";o&&(u=`

### ÂΩìÂâçÈÄâ‰∏≠/ÈòÖËØªÁ´†ËäÇ (ÈáçÁÇπÂÖ≥Ê≥®)
Á´†ËäÇÂêçÔºö${o.node_name}
IDÔºö${o.node_id}
ÂÜÖÂÆπÔºö
${o.node_content||"(ÊöÇÊó†ÂÜÖÂÆπ)"}`);const f=d.filter(R=>R.node_id!==(o==null?void 0:o.node_id)&&R.node_content&&e.includes(R.node_name));let b="";f.length>0&&(b=`

### Áõ∏ÂÖ≥Á´†ËäÇÂÜÖÂÆπÔºàÊ†πÊçÆÈóÆÈ¢òËá™Âä®ÊèêÂèñÔºâ
`+f.map(R=>{var K;return`Á´†ËäÇÔºö${R.node_name} (ID: ${R.node_id})
ÂÜÖÂÆπÔºö
${(K=R.node_content)==null?void 0:K.slice(0,3e3)}...`}).join(`

`));const I=`### ËØæÁ®ãÂÆåÊï¥Â§ßÁ∫≤ÁªìÊûÑ
${l}${u}${b}`,g=this.chatHistory.map(R=>({role:R.type==="user"?"user":"assistant",content:typeof R.content=="string"?R.content:R.content.core_answer||""})),S=this.calculateSessionMetrics(),w=this.notes.map(R=>`- [${R.sourceType==="ai"?"AI":"User"}] ${R.content} (Related to Node: ${R.nodeId})`).join(`
`).slice(0,5e3),V={type:"ai",content:{core_answer:"",detail_answer:[],quote:"",anno_summary:"AI ÊÄùËÄÉ‰∏≠...",anno_id:`anno_${crypto.randomUUID()}`,node_id:"",question:e,answer:""}};if(this.chatHistory.push(V),r=this.chatHistory[this.chatHistory.length-1],typeof r.content=="string")return;const F=await fetch(`${_e}/ask`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({node_id:o.node_id,node_name:o.node_name,node_content:I,question:e,history:g,selection:t,user_notes:w,user_persona:this.userPersona,session_metrics:S,enable_long_term_memory:!0}),signal:n.signal});if(!F.ok)throw new Error(`HTTP ${F.status}`);const B=(i=F.body)==null?void 0:i.getReader();if(!B)throw new Error("No reader");const m=new TextDecoder;let h="",$=!1;for(;;){const{done:R,value:K}=await B.read();if(R)break;const U=m.decode(K,{stream:!0});if(h+=U,!$){const Y=h.indexOf("---METADATA---");if(Y!==-1){const G=h.substring(0,Y);r.content.core_answer=G,r.content.answer=G,$=!0}else r.content.core_answer=h,r.content.answer=h}}const z=h.indexOf("---METADATA---");if(z!==-1){const R=h.substring(0,z),K=h.substring(z+14).trim();r.content.core_answer=R.trim(),r.content.answer=R.trim();try{const U=JSON.parse(K);if(U){r.content.node_id=U.node_id,r.content.quote=U.quote,r.content.anno_summary=U.anno_summary||"AI Á¨îËÆ∞";const Y=(U.quote||"").trim(),G=(r.content.core_answer||r.content.answer||"").trim(),J=(U.anno_summary||"").trim(),A=(J&&J!=="AI Á¨îËÆ∞"?J:G).replace(/\s+/g," ").trim();if(Y&&Y.length>=3&&A.length>=8){const ie=`note-${Date.now()}`,te=U.node_id||r.content.node_id||((a=this.currentNode)==null?void 0:a.node_id)||"",pe=J&&J!=="AI Á¨îËÆ∞"?J:G.length>50?`${G.slice(0,50)}...`:G;this.activeAnnotation={anno_id:ie,node_id:te,question:"AI Á¨îËÆ∞",answer:G,anno_summary:pe||"AI Á¨îËÆ∞",source_type:"ai_chat",quote:Y};const $e=`highlight-${Date.now()}`;this.createNote({id:ie,nodeId:te,highlightId:$e,quote:Y,content:G,summary:pe,color:"purple",createdAt:Date.now(),sourceType:"ai"}),r.content.anno_id=ie,U.node_id&&(this.scrollToNode(U.node_id),setTimeout(()=>{this.focusNoteId=null,setTimeout(()=>{this.focusNoteId=ie},50)},100))}}}catch(U){console.warn("Failed to parse metadata",U)}}else r.content.core_answer=h,r.content.answer=h}catch(d){if(n!=null&&n.signal.aborted||(d==null?void 0:d.name)==="AbortError"){r&&typeof r.content!="string"&&(r.content.core_answer="Â∑≤ÂÅúÊ≠¢ÁîüÊàê",r.content.answer="Â∑≤ÂÅúÊ≠¢ÁîüÊàê",r.content.anno_summary="Â∑≤ÂÅúÊ≠¢ÁîüÊàê");return}console.error(d),x.error("ÊèêÈóÆÂ§±Ë¥•"),r&&typeof r.content!="string"&&(r.content.core_answer="ÁîüÊàêÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ",r.content.answer="ÁîüÊàêÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ",r.content.anno_summary="ÁîüÊàêÂ§±Ë¥•")}finally{this.loading=!1,this.chatLoading=!1,this.chatAbortController===n&&(this.chatAbortController=null)}},calculateSessionMetrics(){const e={total_messages:this.chatHistory.length,user_messages:this.chatHistory.filter(s=>s.type==="user").length,ai_messages:this.chatHistory.filter(s=>s.type==="ai").length,session_duration_minutes:0,topics_discussed:[],question_types:{conceptual:0,procedural:0,troubleshooting:0,exploratory:0}};this.chatHistory.length>=2&&(e.session_duration_minutes=Math.max(1,Math.floor(this.chatHistory.length/2)));const t=this.chatHistory.filter(s=>s.type==="user").map(s=>typeof s.content=="string"?s.content:"");return e.topics_discussed=this.extractSessionTopics(t),t.forEach(s=>{const n=s.toLowerCase();n.includes("‰∏∫‰ªÄ‰πà")||n.includes("ÊòØ‰ªÄ‰πà")||n.includes("Ê¶ÇÂøµ")?e.question_types.conceptual++:n.includes("ÊÄé‰πà")||n.includes("Â¶Ç‰Ωï")||n.includes("Ê≠•È™§")?e.question_types.procedural++:n.includes("ÈîôËØØ")||n.includes("ÈóÆÈ¢ò")||n.includes("Â§±Ë¥•")?e.question_types.troubleshooting++:e.question_types.exploratory++}),e},extractSessionTopics(e){const t=new Set,s=["Ê¶ÇÂøµ","ÂéüÁêÜ","ÂÆö‰πâ","ÊñπÊ≥ï","Ê≠•È™§","ÊµÅÁ®ã","ÂáΩÊï∞","Á±ª","ÂØπË±°","ÂèòÈáè","ÁÆóÊ≥ï","Êï∞ÊçÆÁªìÊûÑ","ÂâçÁ´Ø","ÂêéÁ´Ø","Êï∞ÊçÆÂ∫ì","API","Ê°ÜÊû∂","Â∫ì","ÈîôËØØ","ÂºÇÂ∏∏","Ë∞ÉËØï","‰ºòÂåñ","ÊÄßËÉΩ","ÂÆâÂÖ®"];return e.forEach(n=>{s.forEach(r=>{n.includes(r)&&t.add(r)})}),Array.from(t).slice(0,10)},saveSessionMemory(e,t){try{const s=`session_memory_${e}`,n=localStorage.getItem(s);let r=n?JSON.parse(n):[];t.timestamp=Date.now(),r.push(t),r.length>50&&(r=r.slice(-50)),localStorage.setItem(s,JSON.stringify(r))}catch(s){console.warn("Failed to save session memory:",s)}},getSessionMemories(e,t=10){try{const s=`session_memory_${e}`,n=localStorage.getItem(s);return n?JSON.parse(n).slice(-t):[]}catch(s){return console.warn("Failed to get session memories:",s),[]}},clearSessionMemories(e){try{const t=`session_memory_${e}`;localStorage.removeItem(t)}catch(t){console.warn("Failed to clear session memories:",t)}},async generateSubNodes(e){if(this.currentCourseId){this.loading=!0;try{const s=(await O.post(`/courses/${this.currentCourseId}/nodes/${e.node_id}/subnodes`,{node_id:e.node_id,node_name:e.node_name,node_level:e.node_level})).data;this.nodes.push(...s),this.courseTree=this.buildTree(this.nodes),x.success("Â≠êÁ´†ËäÇÁîüÊàêÊàêÂäü")}catch{x.error("ÁîüÊàêÂ§±Ë¥•")}finally{this.loading=!1}}},async summarizeChat(){if(this.chatHistory.length===0)return x.warning("Ê≤°ÊúâÂèØÊÄªÁªìÁöÑÂØπËØù"),null;this.chatLoading=!0;try{const e=this.chatHistory.map(n=>({role:n.type==="user"?"user":"assistant",content:typeof n.content=="string"?n.content:n.content.core_answer||""})),t=this.currentNode?`ÂΩìÂâçÁ´†ËäÇÔºö${this.currentNode.node_name}`:"ÂÖ®‰π¶Ê¶ÇËßà";return(await j.post(`${_e}/summarize_chat`,{history:e,course_context:t,user_persona:this.userPersona})).data}catch(e){return console.error(e),x.error("ÊÄªÁªìÁîüÊàêÂ§±Ë¥•"),null}finally{this.chatLoading=!1}},async generateQuizFromSummary(e){if(!this.currentNode)return;const t=`Âü∫‰∫é‰ª•‰∏ãÂ§çÁõòÂÜÖÂÆπÁîüÊàêÊµãÈ™åÔºö
${e.slice(0,2e3)}`;this.addMessage("user","ËØ∑Ê†πÊçÆÂàöÊâçÁöÑÂ§çÁõòÂÜÖÂÆπÔºåÂ∏ÆÊàëÂá∫Âá†ÈÅìÈ¢òÂ∑©Âõ∫‰∏Ä‰∏ã„ÄÇ"),await this.askQuestion(t)},async redefineContent(e,t){var i;if(!this.currentCourseId)return;this.loading=!0;const s=this.nodes.filter(a=>a.node_level<=2).map(a=>`${"  ".repeat(a.node_level-1)}- ${a.node_name}`).join(`
`);let n="";const r=this.getLinearNodes(this.courseTree),o=r.findIndex(a=>a.node_id===e.node_id);if(o>0){const a=r[o-1];a&&a.node_content&&(n=`‰∏äËäÇÂõûÈ°æ (${a.node_name}): `+a.node_content.slice(-500))}try{e.node_content="",e.node_type="custom";const d=(i=(await fetch(`${_e}/courses/${this.currentCourseId}/nodes/${e.node_id}/redefine_stream`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({node_id:e.node_id,node_name:e.node_name,original_content:e.node_content,user_requirement:t,course_context:s,previous_context:n})})).body)==null?void 0:i.getReader();if(d){const l=new TextDecoder;for(;;){const{done:u,value:f}=await d.read();if(u)break;const b=l.decode(f,{stream:!0});this.addToBuffer(e.node_id,b)}}x.success("ÂÜÖÂÆπÈáçÂÜôÊàêÂäü")}catch{x.error("ÈáçÂÜôÂ§±Ë¥•")}finally{this.loading=!1}},async generateBody(e){var i,a;if(!this.currentCourseId)return;this.loading=!0;const t=e.node_content||"",s=this.nodes.filter(d=>d.node_level<=2).map(d=>`${"  ".repeat(d.node_level-1)}- ${d.node_name}`).join(`
`);let n="";const r=this.getLinearNodes(this.courseTree),o=r.findIndex(d=>d.node_id===e.node_id);if(o>0){const d=r[o-1];d&&d.node_content&&(n=`‰∏äËäÇÂõûÈ°æ (${d.node_name}): `+d.node_content.slice(-500))}n+=`
Êú¨ËäÇÁÆÄ‰ªã: ${t}`;try{(i=e.node_content)!=null&&i.includes("<!-- BODY_START -->")||(e.node_content=(e.node_content||"")+`

<!-- BODY_START -->

`);const l=(a=(await fetch(`${_e}/courses/${this.currentCourseId}/nodes/${e.node_id}/redefine_stream`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({node_id:e.node_id,node_name:e.node_name,original_content:"",user_requirement:"Âü∫‰∫éÁÆÄ‰ªãÊí∞ÂÜôÊïôÁßë‰π¶Á∫ßËØ¶ÁªÜÊ≠£ÊñáÔºå‰∏çË¶ÅÈáçÂ§çÁÆÄ‰ªãÂÜÖÂÆπ",course_context:s,previous_context:n})})).body)==null?void 0:a.getReader();if(l){const u=new TextDecoder;for(;;){const{done:f,value:b}=await l.read();if(f)break;const I=u.decode(b,{stream:!0});this.addToBuffer(e.node_id,I)}}x.success("Ê≠£ÊñáÁîüÊàêÂÆåÊàê")}catch(d){x.error("ÁîüÊàêÂ§±Ë¥•"),console.error(d)}finally{this.loading=!1}},async extendContent(e,t){if(this.currentCourseId){this.loading=!0;try{const s=await O.post(`/courses/${this.currentCourseId}/nodes/${e.node_id}/extend`,{node_id:e.node_id,node_name:e.node_name,current_content:e.node_content,user_requirement:t});e.node_content+=`

${s.data.node_content}`,x.success("ÂÜÖÂÆπÊâ©Â±ïÊàêÂäü")}catch{x.error("Êâ©Â±ïÂ§±Ë¥•")}finally{this.loading=!1}}},async locateNode(e){if(this.currentCourseId){this.loading=!0;try{const t=await j.post(`${_e}/courses/${this.currentCourseId}/locate`,{keyword:e});if(t.data.target_node_id){const s=this.nodes.find(n=>n.node_id===t.data.target_node_id);s&&(this.currentNode=s,x.success(`Â∑≤ÂÆö‰ΩçÂà∞: ${s.node_name}`))}else x.warning("Êú™ÊâæÂà∞Áõ∏ÂÖ≥ËäÇÁÇπ")}catch{x.error("ÂÆö‰ΩçÂ§±Ë¥•")}finally{this.loading=!1}}},async addCustomNode(e,t){if(this.currentCourseId){this.loading=!0;try{const s=await O.post(`/courses/${this.currentCourseId}/nodes`,{parent_node_id:e,node_name:t});this.nodes.push(s.data),this.courseTree=this.buildTree(this.nodes),x.success("Ê∑ªÂä†ÊàêÂäü")}catch{x.error("Ê∑ªÂä†Â§±Ë¥•")}finally{this.loading=!1}}},async deleteNode(e){if(this.currentCourseId)try{await O.delete(`/courses/${this.currentCourseId}/nodes/${e}`);const t=new Set([e]);let s=!0;for(;s;)s=!1,this.nodes.forEach(n=>{t.has(n.parent_node_id)&&!t.has(n.node_id)&&(t.add(n.node_id),s=!0)});this.nodes=this.nodes.filter(n=>!t.has(n.node_id)),this.courseTree=this.buildTree(this.nodes),x.success("Âà†Èô§ÊàêÂäü")}catch{x.error("Âà†Èô§Â§±Ë¥•")}},async renameNode(e,t){if(this.currentCourseId){this.loading=!0;try{await O.put(`/courses/${this.currentCourseId}/nodes/${e}`,{node_name:t});const s=this.nodes.find(n=>n.node_id===e);s&&(s.node_name=t),x.success("ÈáçÂëΩÂêçÊàêÂäü")}catch{x.error("ÈáçÂëΩÂêçÂ§±Ë¥•")}finally{this.loading=!1}}},async generateLearningPath(e,t,s,n){if(!this.currentCourseId)return x.warning("ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∏™ËØæÁ®ã"),null;this.learningPathLoading=!0;try{const r=await O.post(`/courses/${this.currentCourseId}/learning_path`,{goal:e,available_time:t,focus_areas:s||[],weak_areas:n||[]});return this.learningPath=r.data.learning_path,x.success("Â≠¶‰π†Ë∑ØÂæÑÁîüÊàêÊàêÂäü"),this.learningPath}catch(r){return console.error("Failed to generate learning path:",r),x.error("Â≠¶‰π†Ë∑ØÂæÑÁîüÊàêÂ§±Ë¥•"),null}finally{this.learningPathLoading=!1}},async fetchKnowledgeMastery(){if(!this.currentCourseId)return null;this.learningPathLoading=!0;try{const e=await O.get(`/courses/${this.currentCourseId}/knowledge_mastery`);return this.knowledgeMastery=e.data.knowledge_mastery,this.knowledgeMastery}catch(e){return console.error("Failed to fetch knowledge mastery:",e),null}finally{this.learningPathLoading=!1}},async fetchLearningStats(){if(!this.currentCourseId)return null;try{return(await O.get(`/courses/${this.currentCourseId}/learning_stats`)).data}catch(e){return console.error("Failed to fetch learning stats:",e),null}},clearLearningPath(){this.learningPath=null},clearKnowledgeMastery(){this.knowledgeMastery=null},createReviewFromWrongAnswer(e){const t=qt({nodeId:e.nodeId,nodeName:e.nodeName,courseId:this.currentCourseId,content:JSON.stringify({question:e.question,options:e.options,correctIndex:e.correctIndex,userIndex:e.userIndex,explanation:e.explanation}),type:"wrong_answer",difficulty:"hard",tags:["ÈîôÈ¢ò",e.nodeName]});return this.reviewItems.push(t),this.persistReviewItems(),this.updateReviewStats(),t},createReviewFromNote(e){const t=qt({nodeId:e.nodeId,nodeName:e.title||"Á¨îËÆ∞",courseId:this.currentCourseId,content:e.content,type:"note",tags:["Á¨îËÆ∞",e.sourceType||"user"]});return this.reviewItems.push(t),this.persistReviewItems(),this.updateReviewStats(),t},startReviewSession(){const e=at(this.reviewItems),t=[...e.overdue,...e.today];if(t.length===0)return x.info("‰ªäÂ§©Ê≤°ÊúâÈúÄË¶ÅÂ§ç‰π†ÁöÑÂÜÖÂÆπÔºåÁªßÁª≠‰øùÊåÅÔºÅ"),null;const s=Sr(t);return this.currentReviewSession={items:s,currentIndex:0,startTime:Date.now(),correctCount:0},this.currentReviewSession},submitReviewResult(e,t){const s=this.reviewItems.findIndex(o=>(o==null?void 0:o.id)===e);if(s===-1)return null;const n=this.reviewItems[s];if(!n)return null;const r=br(n,t);return this.reviewItems[s]=r,this.currentReviewSession&&(this.currentReviewSession.currentIndex++,t>=3&&this.currentReviewSession.correctCount++),this.persistReviewItems(),this.updateReviewStats(),r},endReviewSession(){if(!this.currentReviewSession)return null;const e=this.currentReviewSession,t=Math.round((Date.now()-e.startTime)/6e4),s=e.items.length>0?Math.round(e.correctCount/e.items.length*100):0,n={totalItems:e.items.length,correctCount:e.correctCount,accuracy:s,duration:t,completed:e.currentIndex>=e.items.length};return this.currentReviewSession=null,n.completed&&x.success(`üéâ Â§ç‰π†ÂÆåÊàêÔºÅÊ≠£Á°ÆÁéá ${s}%ÔºåÁî®Êó∂ ${t} ÂàÜÈíü`),n},getTodayReviewPlan(){return at(this.reviewItems)},updateReviewStats(){this.reviewStats=vr(this.reviewItems)},persistReviewItems(){try{localStorage.setItem("review_items",JSON.stringify(this.reviewItems))}catch(e){console.error("Failed to persist review items:",e)}},restoreReviewItems(){try{const e=localStorage.getItem("review_items");e&&(this.reviewItems=JSON.parse(e),this.updateReviewStats())}catch(e){console.error("Failed to restore review items:",e)}},deleteReviewItem(e){this.reviewItems=this.reviewItems.filter(t=>t.id!==e),this.persistReviewItems(),this.updateReviewStats()},getForgettingRisk(e){const t=this.reviewItems.find(s=>s.id===e);return t?lt(t):null},syncWrongAnswersToReview(){let e=0;return this.wrongAnswers.forEach(t=>{this.reviewItems.some(n=>n.nodeId===t.nodeId&&n.type==="wrong_answer"&&n.content.includes(t.question))||(this.createReviewFromWrongAnswer(t),e++)}),e>0&&x.success(`Â∑≤ÂêåÊ≠• ${e} ÈÅìÈîôÈ¢òÂà∞Â§ç‰π†Á≥ªÁªü`),e},setReviewItems(e){const t=new Set(this.reviewItems.map(n=>n==null?void 0:n.id).filter(Boolean)),s=e.filter(n=>(n==null?void 0:n.id)&&!t.has(n.id));e.forEach(n=>{if(!(n!=null&&n.id))return;const r=this.reviewItems.findIndex(o=>(o==null?void 0:o.id)===n.id);if(r!==-1){const o=this.reviewItems[r];if(!o)return;const i={...o,reviewCount:n.reviewCount??o.reviewCount,nextReviewAt:n.nextReviewAt??o.nextReviewAt};this.reviewItems[r]=i}}),this.reviewItems.push(...s),this.persistReviewItems(),this.updateReviewStats()},setMemoryCurve(e){try{localStorage.setItem("memory_curve",JSON.stringify(e))}catch(t){console.error("Failed to persist memory curve:",t)}}}}),Tr={key:0,class:"fixed bottom-6 left-1/2 -translate-x-1/2 w-[90%] max-w-2xl z-50 flex flex-col font-sans"},Cr={key:0,class:"mb-3 bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-slate-200/50 overflow-hidden flex flex-col max-h-[300px]"},Ir={class:"flex items-center justify-between px-5 py-3 border-b border-slate-100 bg-slate-50/50"},Rr={class:"text-xs font-medium text-slate-400"},kr={class:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-1"},$r={key:0,class:"flex flex-col items-center justify-center h-24 text-slate-400 gap-2"},Nr={class:"w-4 h-4 flex items-center justify-center shrink-0"},Er={key:1,class:"w-1.5 h-1.5 rounded-full bg-slate-300"},Ar={class:"truncate flex-1 font-medium"},Or={key:0,class:"text-xs opacity-70 whitespace-nowrap"},Lr={class:"absolute bottom-0 left-0 h-0.5 bg-slate-100 w-full"},Mr={class:"flex-1 ml-3 min-w-0 flex flex-col justify-center"},Dr={class:"flex items-center gap-2"},Pr={class:"text-sm font-bold text-slate-800 truncate"},Fr={class:"flex items-center gap-2 text-xs text-slate-500 mt-0.5"},qr={key:0,class:"flex items-center gap-1 text-blue-600 font-medium"},Br={key:1,class:"text-amber-600 font-medium"},Ur={key:2,class:"text-red-600 font-medium"},Hr={key:3},jr=["title"],zr=ut({__name:"StatusBar",props:{visible:{type:Boolean},currentTask:{},logs:{},queue:{},progress:{},status:{},meta:{},hint:{}},emits:["close","click","toggle-pause","retry-item"],setup(e,{emit:t}){const s=ne(!1),n=()=>{s.value=!s.value};return(r,o)=>{const i=ue("el-icon");return N(),me(et,{name:"slide-up"},{default:L(()=>[e.visible?(N(),M("div",Tr,[C(et,{name:"expand"},{default:L(()=>[s.value?(N(),M("div",Cr,[p("div",Ir,[o[3]||(o[3]=p("span",{class:"text-xs font-bold text-slate-500 uppercase tracking-wider"},"‰ªªÂä°ÈòüÂàó",-1)),p("span",Rr," Ââ©‰Ωô "+Z(e.queue.filter(a=>a.status!=="completed"&&a.status!=="error").length)+" È°π ",1)]),p("div",kr,[e.queue.filter(a=>a.status==="running"||a.status==="pending").length===0?(N(),M("div",$r,[...o[4]||(o[4]=[p("span",{class:"text-sm"},"ÈòüÂàóÁ©∫Èó≤",-1)])])):W("",!0),(N(!0),M(Ie,null,Ee(e.queue.filter(a=>a.status==="running"||a.status==="pending"),a=>(N(),M("div",{key:a.uuid,class:X(["flex items-center gap-3 px-3 py-2 rounded-lg transition-colors text-sm",[a.status==="running"?"bg-blue-50 text-blue-700":"text-slate-600"]])},[p("div",Nr,[a.status==="running"?(N(),me(i,{key:0,class:"animate-spin text-blue-500"},{default:L(()=>[C(T(st))]),_:1})):(N(),M("div",Er))]),p("span",Ar,Z(a.title),1),a.status==="running"?(N(),M("span",Or,"ËøõË°å‰∏≠...")):W("",!0)],2))),128))])])):W("",!0)]),_:1}),p("div",{onClick:n,class:"h-14 bg-white shadow-[0_8px_30px_rgba(0,0,0,0.12)] rounded-full border border-slate-100 flex items-center px-2 relative overflow-hidden cursor-pointer hover:shadow-[0_8px_35px_rgba(0,0,0,0.16)] transition-all duration-300 group"},[p("div",Lr,[p("div",{class:"h-full bg-blue-500 transition-all duration-500 ease-out",style:tt({width:e.progress+"%"})},null,4)]),p("div",{class:X(["w-10 h-10 rounded-full flex items-center justify-center shrink-0 ml-1",{"bg-blue-50 text-blue-600":e.status==="generating","bg-amber-50 text-amber-600":e.status==="paused","bg-slate-50 text-slate-400":e.status==="idle","bg-red-50 text-red-600":e.status==="error"}])},[e.status==="generating"?(N(),me(i,{key:0,class:"text-lg animate-spin"},{default:L(()=>[C(T(st))]),_:1})):e.status==="paused"?(N(),me(i,{key:1,class:"text-lg"},{default:L(()=>[C(T(_t))]),_:1})):e.status==="error"?(N(),me(i,{key:2,class:"text-lg"},{default:L(()=>[C(T(jt))]),_:1})):(N(),me(i,{key:3,class:"text-lg"},{default:L(()=>[C(T(Rs))]),_:1}))],2),p("div",Mr,[p("div",Dr,[p("span",Pr,Z(e.currentTask||(e.status==="idle"?"ÂáÜÂ§áÂ∞±Áª™":"Â§ÑÁêÜ‰∏≠...")),1)]),p("div",Fr,[e.status==="generating"?(N(),M("span",qr," Ê≠£Âú®ÁîüÊàê ")):e.status==="paused"?(N(),M("span",Br,"Â∑≤ÊöÇÂÅú")):e.status==="error"?(N(),M("span",Ur,"ÂèëÁîüÈîôËØØ")):(N(),M("span",Hr,"Á≠âÂæÖ‰ªªÂä°")),o[6]||(o[6]=p("span",{class:"w-1 h-1 rounded-full bg-slate-300"},null,-1)),p("span",null,Z(e.progress)+"%",1),e.queue.length>0?(N(),M(Ie,{key:4},[o[5]||(o[5]=p("span",{class:"w-1 h-1 rounded-full bg-slate-300"},null,-1)),p("span",null,"Ââ©‰Ωô "+Z(e.queue.length-e.queue.filter(a=>a.status==="completed").length)+" È°π",1)],64)):W("",!0)])]),p("div",{class:"flex items-center gap-1 mr-2",onClick:o[2]||(o[2]=be(()=>{},["stop"]))},[e.status==="generating"||e.status==="paused"?(N(),M("button",{key:0,onClick:o[0]||(o[0]=be(a=>r.$emit("toggle-pause"),["stop"])),class:"w-8 h-8 rounded-full flex items-center justify-center text-slate-400 hover:bg-slate-100 hover:text-slate-600 transition-colors",title:e.status==="generating"?"ÊöÇÂÅú":"ÁªßÁª≠"},[e.status==="generating"?(N(),me(i,{key:0},{default:L(()=>[C(T(_t))]),_:1})):(N(),me(i,{key:1},{default:L(()=>[C(T(ks))]),_:1}))],8,jr)):W("",!0),p("button",{onClick:be(n,["stop"]),class:"w-8 h-8 rounded-full flex items-center justify-center text-slate-400 hover:bg-slate-100 hover:text-slate-600 transition-colors"},[C(i,{class:X([{"rotate-180":s.value},"transition-transform duration-300"])},{default:L(()=>[C(T($s))]),_:1},8,["class"])]),e.status==="generating"?(N(),M("button",{key:1,onClick:o[1]||(o[1]=be(a=>r.$emit("close"),["stop"])),class:"w-8 h-8 rounded-full flex items-center justify-center text-slate-400 hover:bg-red-50 hover:text-red-500 transition-colors",title:"ÂÅúÊ≠¢ÁîüÊàê"},[C(i,null,{default:L(()=>[C(T(zt))]),_:1})])):W("",!0)])])])):W("",!0)]),_:1})}}}),gt=(e,t)=>{const s=e.__vccOpts||e;for(const[n,r]of t)s[n]=r;return s},Yr=gt(zr,[["__scopeId","data-v-69298375"]]),Gr={class:"knowledge-graph-container"},Jr={class:"graph-toolbar"},Qr={class:"toolbar-left"},Vr={key:0,class:"loading-indicator"},Wr={class:"toolbar-right"},Kr=["disabled"],Xr=["disabled"],Zr=["viewBox"],eo={class:"edges"},to=["d","stroke-width"],so={class:"nodes"},no=["transform","onClick","onMousedown","onMouseenter"],ro=["x","width"],oo=["x","width","filter","stroke"],io=["x","fill"],ao={class:"node-label",x:"5",y:"6","text-anchor":"middle",style:{fill:"#0f172a"}},lo={key:0,class:"empty-state"},uo={key:0,class:"node-detail-panel"},co={class:"panel-header"},ho={class:"panel-content"},fo={class:"info-row"},po={key:0,class:"info-row"},go={class:"info-description"},mo={key:1,class:"info-row"},yo={class:"graph-legend"},wo={class:"legend-items"},_o={class:"legend-label"},bo={key:0,class:"graph-stats"},vo=ut({__name:"KnowledgeGraph",setup(e){const t=gs(),s=ne(!1),n=ne({nodes:[],edges:[]}),r=ne(null),o=ne(null),i=ne(null),a=ne({x:-100,y:-300,width:1e3,height:700}),d=fe(()=>`${a.value.x} ${a.value.y} ${a.value.width} ${a.value.height}`),l=ne(!1),u=ne({x:0,y:0}),f=ne({x:0,y:0}),b=ne(null),I=ne({x:0,y:0}),g=[{value:"root",label:"ËØæÁ®ãÊ†∏ÂøÉ",color:"#4f46e5"},{value:"module",label:"Áü•ËØÜÊ®°Âùó",color:"#7c3aed"},{value:"concept",label:"Ê†∏ÂøÉÊ¶ÇÂøµ",color:"#059669"},{value:"theorem",label:"ÂÖ≥ÈîÆÂÆöÁêÜ",color:"#d97706"},{value:"method",label:"Ê†∏ÂøÉÊñπÊ≥ï",color:"#db2777"},{value:"core",label:"Ê†∏ÂøÉÊ¶ÇÂøµ",color:"#4f46e5"},{value:"basic",label:"Âü∫Á°ÄÊ¶ÇÂøµ",color:"#059669"},{value:"advanced",label:"ËøõÈò∂Ê¶ÇÂøµ",color:"#d97706"},{value:"application",label:"Â∫îÁî®Âú∫ÊôØ",color:"#db2777"}],S=fe(()=>n.value.nodes.length>0);Ut(async()=>{await w()}),bs(()=>t.currentCourseId,async()=>{await w()});async function w(){if(t.currentCourseId)try{const _=await fetch(`/courses/${t.currentCourseId}/knowledge_graph`),y=_.headers.get("content-type");if(_.ok&&y&&y.indexOf("application/json")!==-1){const v=await _.json();v.status==="success"&&v.data.nodes.length>0&&(n.value=v.data,V())}}catch(_){console.error("Failed to load knowledge graph:",_)}}async function P(){if(!t.currentCourseId){x.warning("ËØ∑ÂÖàÈÄâÊã©ËØæÁ®ã");return}s.value=!0;try{const _=await fetch(`/courses/${t.currentCourseId}/knowledge_graph`,{method:"POST"}),y=_.headers.get("content-type");if(_.ok&&y&&y.indexOf("application/json")!==-1){const v=await _.json();v.status==="success"?(n.value=v.data,V(),x.success("Áü•ËØÜÂõæË∞±ÁîüÊàêÊàêÂäü")):x.error("ÁîüÊàêÂ§±Ë¥•: "+(v.message||"Unknown error"))}else x.error("ÁîüÊàêÂ§±Ë¥•: ÊúçÂä°Âô®ËøîÂõûÈîôËØØ")}catch(_){console.error("Failed to generate knowledge graph:",_ instanceof Error?_.message:_),x.error("ÁîüÊàêÂ§±Ë¥•")}finally{s.value=!1}}function V(){const _=n.value.nodes,y=n.value.edges;if(_.length===0)return;const v={},H={};_.forEach(q=>{v[q.id]=[],H[q.id]=[]}),y.forEach(q=>{v[q.source]&&v[q.source].push(q.target),H[q.target]&&H[q.target].push(q.source)});let E=_.filter(q=>(H[q.id]||[]).length===0);if(E.length===0){const q=_.find(Ce=>Ce.type==="root");E=q?[q]:[_[0]]}const Q=new Set;let se=0;const he=280,Te=70,mt=q=>_.find(Ce=>Ce.id===q);function Qe(q,Ce){if(Q.has(q)){const ge=mt(q);return ge?ge.y:se}Q.add(q);const we=mt(q);if(!we)return se;we.x=Ce*he;const yt=(v[q]||[]).filter(ge=>!Q.has(ge));if(yt.length===0)return we.y=se,se+=Te,we.y;{let ge=null,Ve=null;return yt.forEach((ys,ws)=>{const wt=Qe(ys,Ce+1);ws===0&&(ge=wt),Ve=wt}),ge!==null&&Ve!==null?we.y=(ge+Ve)/2:(we.y=se,se+=Te),we.y}}E.forEach(q=>{Qe(q.id,0)}),_.forEach(q=>{Q.has(q.id)||Qe(q.id,0)}),F()}function F(){if(n.value.nodes.length===0)return;const _=300,y=200,v=n.value.nodes.map(Te=>Te.x),H=n.value.nodes.map(Te=>Te.y),E=Math.min(...v)-_,Q=Math.max(...v)+_,se=Math.min(...H)-y,he=Math.max(...H)+y;a.value={x:E,y:se,width:Math.max(Q-E,800),height:Math.max(he-se,600)}}function B(_){const y=n.value.nodes.find(v=>v.id===_);return y?{x:y.x||0,y:y.y||0}:{x:0,y:0}}function m(_){const y=_.label?_.label.length:0;return Math.max(120,y*15+40)}function h(_){const y=g.find(v=>v.value===_.type);return(y==null?void 0:y.color)||"#94a3b8"}function $(_){const y=B(_.source),v=B(_.target),H=v.x-y.x,E=y.x+H*.5,Q=y.y,se=v.x-H*.5,he=v.y;return`M ${y.x} ${y.y} C ${E} ${Q}, ${se} ${he}, ${v.x} ${v.y}`}function z(_){const y=[_.relation];return r.value&&(_.source===r.value.id||_.target===r.value.id?y.push("highlighted"):y.push("dimmed")),y.join(" ")}function R(_){const y=g.find(v=>v.value===_);return(y==null?void 0:y.label)||_}function K(_){r.value=_}function U(){r.value=null}function Y(_){t.scrollToNode(_),x.success("Â∑≤Ë∑≥ËΩ¨Âà∞ÂØπÂ∫îÁ´†ËäÇ")}function G(){F()}function J(){if(!i.value)return;const _=i.value.querySelector("svg");if(!_)return;let v=new XMLSerializer().serializeToString(_);v.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)||(v=v.replace(/^<svg/,'<svg xmlns="http://www.w3.org/2000/svg"')),v.match(/^<svg[^>]+xmlns:xlink="http\:\/\/www\.w3\.org\/1999\/xlink"/)||(v=v.replace(/^<svg/,'<svg xmlns:xlink="http://www.w3.org/1999/xlink"'));const H=new Blob([v],{type:"image/svg+xml;charset=utf-8"}),E=URL.createObjectURL(H),Q=document.createElement("a");Q.href=E,Q.download=`knowledge-graph-${t.currentCourseId}.svg`,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),x.success("Â∑≤ÂØºÂá∫ SVG ÂõæÁâá")}function de(_){const y=_.deltaY>0?1.1:.9,v=a.value.x+a.value.width/2,H=a.value.y+a.value.height/2;a.value.width*=y,a.value.height*=y,a.value.x=v-a.value.width/2,a.value.y=H-a.value.height/2}function A(_,y){if(!i.value)return{x:0,y:0};const v=i.value.getBoundingClientRect(),H=a.value.x+(_-v.left)*(a.value.width/v.width),E=a.value.y+(y-v.top)*(a.value.height/v.height);return{x:H,y:E}}function ie(_,y){b.value=y;const v=A(_.clientX,_.clientY);I.value={x:y.x-v.x,y:y.y-v.y}}function te(_){b.value||(l.value=!0,u.value={x:_.clientX,y:_.clientY},f.value={x:a.value.x,y:a.value.y})}let pe=null;function $e(_){pe||(pe=requestAnimationFrame(()=>{var H,E;if(pe=null,b.value){const Q=A(_.clientX,_.clientY);b.value.x=Q.x+I.value.x,b.value.y=Q.y+I.value.y;return}if(!l.value)return;const y=(_.clientX-u.value.x)*a.value.width/(((H=i.value)==null?void 0:H.clientWidth)||800),v=(_.clientY-u.value.y)*a.value.height/(((E=i.value)==null?void 0:E.clientHeight)||600);a.value.x=f.value.x-y,a.value.y=f.value.y-v}))}function le(){l.value=!1,b.value=null}return(_,y)=>{const v=ue("el-icon"),H=ue("Download");return N(),M("div",Gr,[p("div",Jr,[p("div",Qr,[y[3]||(y[3]=p("span",{class:"graph-title"},"Áü•ËØÜÂõæË∞±",-1)),s.value?(N(),M("span",Vr,[C(v,{class:"is-loading"},{default:L(()=>[C(T(st))]),_:1}),y[2]||(y[2]=ye(" ÁîüÊàê‰∏≠... ",-1))])):W("",!0)]),p("div",Wr,[S.value?(N(),M("button",{key:1,class:"btn-refresh",disabled:s.value,onClick:P},[C(v,null,{default:L(()=>[C(T(Ns))]),_:1}),y[5]||(y[5]=ye(" ÈáçÊñ∞ÁîüÊàê ",-1))],8,Xr)):(N(),M("button",{key:0,class:"btn-generate",disabled:s.value,onClick:P},[C(v,null,{default:L(()=>[C(T(bt))]),_:1}),y[4]||(y[4]=ye(" ÁîüÊàêÂõæË∞± ",-1))],8,Kr)),p("button",{class:"btn-reset",onClick:G},[C(v,null,{default:L(()=>[C(T(Yt))]),_:1}),y[6]||(y[6]=ye(" ÈáçÁΩÆËßÜÂõæ ",-1))]),p("button",{class:"btn-reset",onClick:J,title:"ÂØºÂá∫ÂõæÁâá"},[C(v,null,{default:L(()=>[C(H)]),_:1}),y[7]||(y[7]=ye(" ÂØºÂá∫ ",-1))])])]),p("div",{ref_key:"graphContainer",ref:i,class:"graph-canvas",onClick:U},[(N(),M("svg",{viewBox:d.value,class:"graph-svg",onWheel:be(de,["prevent"]),onMousedown:te,onMousemove:$e,onMouseup:le,onMouseleave:le},[y[8]||(y[8]=Ht('<defs data-v-3e467be4><pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse" data-v-3e467be4><path d="M 40 0 L 0 0 0 40" fill="none" stroke="#f1f5f9" stroke-width="1" data-v-3e467be4></path></pattern><filter id="node-shadow" x="-50%" y="-50%" width="200%" height="200%" data-v-3e467be4><feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000000" flood-opacity="0.1" data-v-3e467be4></feDropShadow></filter><filter id="node-glow" x="-50%" y="-50%" width="200%" height="200%" data-v-3e467be4><feDropShadow dx="0" dy="0" stdDeviation="6" flood-color="#6366f1" flood-opacity="0.5" data-v-3e467be4></feDropShadow></filter><marker id="arrowhead" viewBox="0 0 10 10" refX="28" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse" data-v-3e467be4><path d="M 0 0 L 10 5 L 0 10 z" fill="#64748b" data-v-3e467be4></path></marker></defs><rect width="100%" height="100%" fill="url(#grid)" data-v-3e467be4></rect>',2)),p("g",eo,[(N(!0),M(Ie,null,Ee(n.value.edges,E=>(N(),M("path",{key:`${E.source}-${E.target}`,d:$(E),class:X(["edge-line",z(E)]),"stroke-width":r.value&&(E.source===r.value.id||E.target===r.value.id)?3:2,"marker-end":"url(#arrowhead)"},null,10,to))),128))]),p("g",so,[(N(!0),M(Ie,null,Ee(n.value.nodes,E=>{var Q,se;return N(),M("g",{key:E.id,class:"node-group",transform:`translate(${B(E.id).x}, ${B(E.id).y})`,onClick:be(he=>K(E),["stop"]),onMousedown:be(he=>ie(he,E),["stop"]),onMouseenter:he=>o.value=E.id,onMouseleave:y[0]||(y[0]=he=>o.value=null)},[p("rect",{x:-m(E)/2-10,y:-30,width:m(E)+20,height:"60",fill:"transparent"},null,8,ro),p("rect",{x:-m(E)/2,y:-22,width:m(E),height:"44",rx:"6",ry:"6",class:"node-card-bg",filter:((Q=r.value)==null?void 0:Q.id)===E.id?"url(#node-glow)":"url(#node-shadow)",stroke:((se=r.value)==null?void 0:se.id)===E.id?"#6366f1":"transparent","stroke-width":"2"},null,8,oo),p("rect",{x:-m(E)/2,y:-22,width:"5",height:"44",rx:"0",class:"node-type-strip",fill:h(E),style:{"border-top-left-radius":"6px","border-bottom-left-radius":"6px"}},null,8,io),p("text",ao,Z(E.label),1)],40,no)}),128))])],40,Zr)),!S.value&&!s.value?(N(),M("div",lo,[C(v,{class:"empty-icon"},{default:L(()=>[C(T(bt))]),_:1}),y[9]||(y[9]=p("p",{class:"empty-text"},"ÊöÇÊó†Áü•ËØÜÂõæË∞±Êï∞ÊçÆ",-1)),p("button",{class:"btn-generate-large",onClick:P}," Á´ãÂç≥ÁîüÊàê ")])):W("",!0),C(et,{name:"slide"},{default:L(()=>[r.value?(N(),M("div",uo,[p("div",co,[p("h3",null,Z(r.value.label),1),p("button",{class:"btn-close",onClick:U},[C(v,null,{default:L(()=>[C(T(jt))]),_:1})])]),p("div",ho,[p("div",fo,[y[10]||(y[10]=p("span",{class:"info-label"},"Á±ªÂûã:",-1)),p("span",{class:"info-value",style:tt({background:h(r.value)+"20",color:h(r.value)})},Z(R(r.value.type)),5)]),r.value.description?(N(),M("div",po,[y[11]||(y[11]=p("span",{class:"info-label"},"ÊèèËø∞:",-1)),p("p",go,Z(r.value.description),1)])):W("",!0),r.value.chapter_id?(N(),M("div",mo,[p("button",{class:"btn-navigate",onClick:y[1]||(y[1]=E=>Y(r.value.chapter_id))},[C(v,null,{default:L(()=>[C(T(Es))]),_:1}),y[12]||(y[12]=ye(" ÂâçÂæÄÂ≠¶‰π† ",-1))])])):W("",!0)])])):W("",!0)]),_:1})],512),p("div",yo,[y[13]||(y[13]=p("div",{class:"legend-title"},"Âõæ‰æã",-1)),p("div",wo,[(N(),M(Ie,null,Ee(g,E=>p("div",{key:E.value,class:"legend-item"},[p("span",{class:"legend-dot",style:tt({background:E.color})},null,4),p("span",_o,Z(E.label),1)])),64))])]),S.value?(N(),M("div",bo,[p("span",null,Z(n.value.nodes.length)+" ‰∏™ËäÇÁÇπ",1),p("span",null,Z(n.value.edges.length)+" Êù°ÂÖ≥Á≥ª",1)])):W("",!0)])}}}),xo=gt(vo,[["__scopeId","data-v-3e467be4"]]),So={class:"h-screen w-full flex items-center justify-center p-0 xl:p-2 overflow-hidden bg-gradient-to-b from-slate-50 to-slate-100 relative font-sans selection:bg-primary-500/20 selection:text-primary-900 antialiased"},To={class:"w-full h-full flex flex-col gap-3 relative z-10"},Co={class:"h-14 xl:h-16 flex-shrink-0 flex items-center justify-between px-3 xl:px-6 glass-panel-tech-floating rounded-none xl:rounded-xl z-20 relative animate-fade-in-up border-b xl:border-none border-slate-200/50"},Io={key:0,class:"absolute left-1/2 -translate-x-1/2 hidden md:flex items-center gap-2 bg-white/60 backdrop-blur-sm rounded-full px-4 py-1.5 border border-slate-200/60 shadow-sm"},Ro={class:"font-semibold text-slate-800 truncate max-w-[200px]"},ko={class:"flex items-center gap-3"},$o={key:0,class:"flex items-center gap-2"},No={class:"relative mr-2"},Eo=["value"],Ao={key:0,class:"absolute top-full left-0 right-0 mt-3 bg-white/95 backdrop-blur-xl rounded-xl shadow-lg border border-slate-100 p-2 z-50 max-h-80 overflow-auto"},Oo={class:"flex items-center justify-between px-2 py-1.5 mb-1 border-b border-slate-100"},Lo={class:"text-[10px] text-slate-400 bg-slate-100 rounded-full px-2 py-0.5"},Mo=["onClick"],Do={class:"flex items-center justify-between"},Po={class:"font-medium text-slate-700 text-sm truncate group-hover/item:text-primary-600"},Fo=["innerHTML"],qo={key:0,class:"absolute inset-0 -translate-x-full group-hover:animate-[shimmer_1.5s_infinite] bg-gradient-to-r from-transparent via-indigo-50/50 to-transparent z-0"},Bo={class:"glass-icon-btn",title:"Â§ñËßÇËÆæÁΩÆ"},Uo={class:"p-2 space-y-4"},Ho={class:"space-y-2"},jo={class:"flex items-center gap-2 bg-slate-100 rounded-lg p-1"},zo={class:"text-xs font-mono w-8 text-center"},Yo={class:"space-y-2"},Go={class:"grid grid-cols-3 gap-2"},Jo={class:"space-y-2"},Qo={class:"grid grid-cols-3 gap-2"},Vo={class:"glass-icon-btn",title:"ÂØºÂá∫"},Wo={class:"h-[70vh]"},Ko=ut({__name:"App",setup(e){const t=gs(),s=xs(),n=fe(()=>{const m=t.getTask(t.currentCourseId);return m&&(m.status==="running"||m.status==="pending"||m.status==="paused")||t.generationStatus!=="idle"||t.chatLoading||t.loading?!0:t.queue.some(h=>h.status==="running"||h.status==="pending")}),r=fe(()=>{const m=t.getTask(t.currentCourseId);if(m){if(m.status==="running")return"generating";if(m.status==="paused")return"paused";if(m.status==="error")return"error"}return t.generationStatus==="error"?"error":t.isGenerating||t.chatLoading?"generating":t.loading||t.queue.some(h=>h.status==="running"||h.status==="pending")?"paused":"idle"}),o=fe(()=>{const m=t.getTask(t.currentCourseId);return m&&(m.status==="running"||m.status==="pending"||m.status==="paused")?m.currentStep||"ÂêéÂè∞‰ªªÂä°Â§ÑÁêÜ‰∏≠...":t.isGenerating?t.currentGeneratingNode||"ÂÜÖÂÆπÁîüÊàê‰∏≠":t.chatLoading?"AI ÁîüÊàê‰∏≠":t.loading?"Êï∞ÊçÆÂä†ËΩΩ‰∏≠":t.queue.some(h=>h.status==="running"||h.status==="pending")?"ÈòüÂàóÁ≠âÂæÖ‰∏≠":null}),i=fe(()=>{const m=t.getTask(t.currentCourseId);return m&&(m.status==="running"||m.status==="pending"||m.status==="paused")?m.progress||0:t.isGenerating?t.generationProgress:t.chatLoading?35:t.loading?15:t.queue.some(h=>h.status==="running"||h.status==="pending")?5:0}),a=fe(()=>{const m=t.courseList.find(h=>h.course_id===t.currentCourseId);return(m==null?void 0:m.course_name)||"Êú™ÈÄâÊã©"}),d=fe(()=>{const m=t.queue.filter(z=>z.status==="pending").length,h=t.queue.filter(z=>z.status==="running").length,$=[{label:"ËØæÁ®ã",value:a.value,tone:"primary"},{label:"Á¨îËÆ∞",value:String(t.notes.length),tone:"success"}];return t.currentNode&&$.push({label:"Á´†ËäÇ",value:t.currentNode.node_name,tone:"muted"}),(h>0||m>0)&&$.push({label:"ÁîüÊàêÈòüÂàó",value:`${h} ËøêË°å / ${m} Á≠âÂæÖ`,tone:"warning"}),t.chatLoading&&$.push({label:"AIÁä∂ÊÄÅ",value:"ÊÄùËÄÉ‰∏≠...",tone:"primary"}),$}),l=fe(()=>{const m=t.generationLogs[t.generationLogs.length-1];return m||(t.chatLoading?"AI Ê≠£Âú®ÊÄùËÄÉ‰∏éÁîüÊàêÂÜÖÂÆπ":t.loading?"Ê≠£Âú®Âä†ËΩΩËØæÁ®ãÊï∞ÊçÆ":"")}),u=ne([]),f=ne(!1),b=fe(()=>{const m=[],h=$=>{m.push($),$.children&&$.children.forEach(h)};return t.courseTree.forEach(h),m}),I=m=>{let h;if(typeof m=="string"?h=m:m&&m.target?h=m.target.value:h="",!h||!h.trim()){u.value=[],t.globalSearchQuery="";return}t.globalSearchQuery=h;const $=h.toLowerCase().trim(),z=[];b.value.forEach(R=>{if(R.node_level===1)return;const K=R.node_name.toLowerCase().includes($),U=R.node_content&&R.node_content.toLowerCase().includes($);if(K||U){let Y="";if(U){const G=R.node_content.toLowerCase().indexOf($),J=Math.max(0,G-20),de=Math.min(R.node_content.length,G+60);Y="..."+R.node_content.substring(J,de)+"...";const A=$.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ie=new RegExp(`(${A})`,"gi");Y=Y.replace(ie,'<span class="text-primary-600 font-bold">$1</span>')}else Y="Ê†áÈ¢òÂåπÈÖç";z.push({id:R.node_id,title:R.node_name,preview:Y})}}),u.value=z.slice(0,8)},g=m=>{t.scrollToNode(m);const h=b.value.find($=>$.node_id===m);h&&t.setCurrentNodeSilent(h),t.globalSearchQuery="",u.value=[]},S=()=>{t.isFocusMode=!t.isFocusMode},w=m=>{m==="json"?t.exportCourseJson():m==="markdown"&&t.exportCourseMarkdown()},P=m=>{const $=m.target.closest(".copy-btn");if($){const z=$.getAttribute("data-code");if(z){let R="";try{R=decodeURIComponent(z)}catch{R=z}navigator.clipboard.writeText(R).then(()=>{x.success("‰ª£Á†ÅÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø")}).catch(()=>{x.error("Â§çÂà∂Â§±Ë¥•")})}}},V=()=>{if(t.currentCourseId&&(s.push(`/course/${t.currentCourseId}`),t.currentGeneratingNodeId)){t.scrollToNode(t.currentGeneratingNodeId);const m=b.value.find(h=>h.node_id===t.currentGeneratingNodeId);m&&t.setCurrentNodeSilent(m)}},F=()=>{if(t.currentCourseId){const m=t.getTask(t.currentCourseId);m&&(m.status==="running"?t.pauseTask(t.currentCourseId):t.startTask(t.currentCourseId))}},B=m=>{t.retryQueueItem(m)};return Ut(()=>{document.addEventListener("click",P),t.startGlobalMonitor();const m=t.restoreGenerationState();m&&s.currentRoute.value.path==="/"&&(s.push(`/course/${m}`),x.success("Â∑≤Ëá™Âä®ÊÅ¢Â§ç‰∏äÊ¨°Êú™ÂÆåÊàêÁöÑËØæÁ®ãÁîüÊàê‰ªªÂä°"))}),vs(()=>{document.removeEventListener("click",P),t.stopGlobalMonitor()}),(m,h)=>{var de;const $=ue("el-icon"),z=ue("Connection"),R=ue("el-popover"),K=ue("el-dropdown-item"),U=ue("el-dropdown-menu"),Y=ue("el-dropdown"),G=ue("router-view"),J=ue("el-dialog");return N(),M("div",So,[h[25]||(h[25]=p("div",{class:"absolute inset-0 z-0 pointer-events-none overflow-hidden bg-slate-50/50"},[p("div",{class:"absolute inset-0 opacity-30 bg-gradient-to-br from-indigo-50/50 via-slate-50 to-blue-50/50"}),p("div",{class:"absolute top-[-20%] right-[-10%] w-[60%] h-[60%] bg-indigo-100/20 rounded-full blur-[100px] opacity-40"}),p("div",{class:"absolute bottom-[-20%] left-[-10%] w-[60%] h-[60%] bg-blue-100/20 rounded-full blur-[100px] opacity-40"})],-1)),p("div",To,[p("header",Co,[p("div",{class:"flex items-center gap-2 xl:gap-3 cursor-pointer group",onClick:h[0]||(h[0]=A=>T(s).push("/"))},[...h[14]||(h[14]=[Ht('<div class="w-8 h-8 xl:w-10 xl:h-10 bg-primary-600 rounded-lg xl:rounded-xl flex items-center justify-center text-white shadow-md transition-all duration-200 relative overflow-hidden group-hover:shadow-lg group-hover:scale-105" data-v-2f9e2163><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 xl:w-6 xl:h-6 relative z-10" data-v-2f9e2163><path d="M11.7 2.805a.75.75 0 01.6 0A60.65 60.65 0 0122.83 8.72a.75.75 0 01-.231 1.337 49.949 49.949 0 00-9.902 3.912l-.003.002-.34.18a.75.75 0 01-.707 0A50.009 50.009 0 002.21 10.057a.75.75 0 01-.231-1.337A60.653 60.653 0 0111.7 2.805z" data-v-2f9e2163></path><path d="M13.06 15.473a48.45 48.45 0 017.666-3.282c.134 1.438.227 2.945.227 4.53 0 5.705-3.276 10.675-8.25 13.05a.75.75 0 01-.706 0C7.026 27.478 3.75 22.508 3.75 16.8c0-1.66.103-3.235.249-4.735a48.51 48.51 0 017.76 3.42c.433.224.943.224 1.301-.012z" data-v-2f9e2163></path></svg></div><div data-v-2f9e2163><h1 class="text-lg font-semibold tracking-tight font-display text-slate-900" data-v-2f9e2163>ÁÅµÁü• (KnowledgeMap)</h1></div>',2)])]),T(t).currentCourseId?(N(),M("div",Io,[p("span",Ro,Z(((de=T(t).courseList.find(A=>A.course_id===T(t).currentCourseId))==null?void 0:de.course_name)||"ËØæÁ®ãÈ¢ÑËßà"),1),h[15]||(h[15]=p("span",{class:"text-slate-300"},"|",-1)),h[16]||(h[16]=p("span",{class:"text-xs text-slate-500"},"ÂÖ®‰π¶Ê®°Âºè",-1))])):W("",!0),p("div",ko,[T(t).currentCourseId?(N(),M("div",$o,[p("div",No,[p("div",{class:X(["relative transition-all duration-300 ease-out",f.value?"w-80":"w-56"])},[p("div",{class:X(["absolute -inset-[1px] bg-gradient-to-r from-primary-400/0 via-primary-500/30 to-primary-400/0 rounded-full opacity-0 blur-[2px] transition-opacity duration-300",f.value?"opacity-100":""])},null,2),p("div",{class:X(["relative flex items-center bg-white rounded-full h-9 shadow-sm border border-slate-200/60 transition-all duration-300",f.value?"shadow-[0_0_20px_rgba(139,92,246,0.25)] border-primary-300/50":"hover:shadow-md hover:border-slate-300/60"])},[p("div",{class:X(["pl-3 pr-2 text-slate-400 transition-colors duration-300",f.value?"text-primary-500":""])},[C($,{size:16},{default:L(()=>[C(T(As))]),_:1})],2),p("input",{value:T(t).globalSearchQuery,type:"text",placeholder:"ÊêúÁ¥¢ÂÖ®‰π¶ÂÜÖÂÆπ...",class:"flex-1 bg-transparent border-none outline-none focus:outline-none focus:ring-0 text-sm text-slate-700 placeholder:text-slate-400/70 h-full pr-3",onInput:I,onFocus:h[1]||(h[1]=A=>f.value=!0),onBlur:h[2]||(h[2]=A=>f.value=!1)},null,40,Eo),T(t).globalSearchQuery?(N(),M("button",{key:0,class:"mr-2 text-slate-400 hover:text-slate-600 transition-colors",onClick:h[3]||(h[3]=A=>{T(t).globalSearchQuery="",u.value=[]})},[C($,{size:14},{default:L(()=>[C(T(zt))]),_:1})])):W("",!0)],2)],2),u.value.length>0?(N(),M("div",Ao,[p("div",Oo,[h[17]||(h[17]=p("span",{class:"text-[11px] font-medium text-slate-500"},"ÊêúÁ¥¢ÁªìÊûú",-1)),p("span",Lo,Z(u.value.length),1)]),(N(!0),M(Ie,null,Ee(u.value,(A,ie)=>(N(),M("div",{key:ie,class:"px-3 py-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors group/item",onClick:te=>g(A.id)},[p("div",Do,[p("span",Po,Z(A.title),1),C($,{class:"text-slate-300 group-hover/item:text-primary-400",size:14},{default:L(()=>[C(T(Os))]),_:1})]),p("p",{class:"text-xs text-slate-500 mt-0.5 line-clamp-1",innerHTML:A.preview},null,8,Fo)],8,Mo))),128))])):W("",!0)]),p("button",{class:X(["flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all duration-300 border shadow-sm group relative overflow-hidden",T(t).showKnowledgeGraph?"bg-indigo-600 text-white border-indigo-600 shadow-indigo-200":"bg-white text-slate-700 border-slate-200 hover:border-indigo-300 hover:text-indigo-600 hover:shadow-md"]),onClick:h[4]||(h[4]=A=>T(t).showKnowledgeGraph=!0)},[T(t).showKnowledgeGraph?W("",!0):(N(),M("div",qo)),C($,{size:16,class:"relative z-10"},{default:L(()=>[C(z)]),_:1}),h[18]||(h[18]=p("span",{class:"relative z-10"},"Áü•ËØÜÂõæË∞±",-1))],2),C(R,{placement:"bottom",width:240,trigger:"click","popper-class":"glass-popover"},{reference:L(()=>[p("button",Bo,[C($,{size:18},{default:L(()=>[C(T(Ds))]),_:1})])]),default:L(()=>[p("div",Uo,[p("div",Ho,[h[19]||(h[19]=p("div",{class:"text-xs font-bold text-slate-500"},"Â≠óÂè∑",-1)),p("div",jo,[p("button",{class:"flex-1 p-1 hover:bg-white rounded text-slate-600",onClick:h[5]||(h[5]=A=>T(t).uiSettings.fontSize=Math.max(8,T(t).uiSettings.fontSize-1))},[C($,null,{default:L(()=>[C(T(Ls))]),_:1})]),p("span",zo,Z(T(t).uiSettings.fontSize),1),p("button",{class:"flex-1 p-1 hover:bg-white rounded text-slate-600",onClick:h[6]||(h[6]=A=>T(t).uiSettings.fontSize=Math.min(72,T(t).uiSettings.fontSize+1))},[C($,null,{default:L(()=>[C(T(Ms))]),_:1})])])]),p("div",Yo,[h[20]||(h[20]=p("div",{class:"text-xs font-bold text-slate-500"},"Â≠ó‰Ωì",-1)),p("div",Go,[p("button",{class:X(["px-2 py-1 text-xs border rounded hover:border-primary-500",T(t).uiSettings.fontFamily==="sans"?"bg-primary-50 border-primary-500 text-primary-600":"bg-white border-slate-200"]),onClick:h[7]||(h[7]=A=>T(t).uiSettings.fontFamily="sans")},"Êó†Ë°¨Á∫ø",2),p("button",{class:X(["px-2 py-1 text-xs border rounded hover:border-primary-500 font-serif",T(t).uiSettings.fontFamily==="serif"?"bg-primary-50 border-primary-500 text-primary-600":"bg-white border-slate-200"]),onClick:h[8]||(h[8]=A=>T(t).uiSettings.fontFamily="serif")},"Ë°¨Á∫ø",2),p("button",{class:X(["px-2 py-1 text-xs border rounded hover:border-primary-500 font-mono",T(t).uiSettings.fontFamily==="mono"?"bg-primary-50 border-primary-500 text-primary-600":"bg-white border-slate-200"]),onClick:h[9]||(h[9]=A=>T(t).uiSettings.fontFamily="mono")},"Á≠âÂÆΩ",2)])]),p("div",Jo,[h[21]||(h[21]=p("div",{class:"text-xs font-bold text-slate-500"},"Ë°åÈ´ò",-1)),p("div",Qo,[p("button",{class:X(["px-2 py-1 text-xs border rounded hover:border-primary-500",T(t).uiSettings.lineHeight===1.5?"bg-primary-50 border-primary-500 text-primary-600":"bg-white border-slate-200"]),onClick:h[10]||(h[10]=A=>T(t).uiSettings.lineHeight=1.5)},"Á¥ßÂáë",2),p("button",{class:X(["px-2 py-1 text-xs border rounded hover:border-primary-500",T(t).uiSettings.lineHeight===1.75?"bg-primary-50 border-primary-500 text-primary-600":"bg-white border-slate-200"]),onClick:h[11]||(h[11]=A=>T(t).uiSettings.lineHeight=1.75)},"ËàíÈÄÇ",2),p("button",{class:X(["px-2 py-1 text-xs border rounded hover:border-primary-500",T(t).uiSettings.lineHeight===2?"bg-primary-50 border-primary-500 text-primary-600":"bg-white border-slate-200"]),onClick:h[12]||(h[12]=A=>T(t).uiSettings.lineHeight=2)},"ÂÆΩÊùæ",2)])])])]),_:1}),p("button",{class:X(["glass-icon-btn",{"!text-primary-600 !bg-primary-50":T(t).isFocusMode}]),onClick:S,title:"‰∏ìÊ≥®Ê®°Âºè (F)"},[C($,{size:18},{default:L(()=>[C(T(Yt))]),_:1})],2),h[24]||(h[24]=p("div",{class:"w-px h-5 bg-slate-200 mx-1"},null,-1)),C(Y,{trigger:"click",onCommand:w},{dropdown:L(()=>[C(U,null,{default:L(()=>[C(K,{command:"json"},{default:L(()=>[...h[22]||(h[22]=[ye("ÂØºÂá∫ JSON Â§á‰ªΩ",-1)])]),_:1}),C(K,{command:"markdown"},{default:L(()=>[...h[23]||(h[23]=[ye("ÂØºÂá∫ Markdown ÊñáÊ°£",-1)])]),_:1})]),_:1})]),default:L(()=>[p("button",Vo,[C($,{size:18},{default:L(()=>[C(T(Ps))]),_:1})])]),_:1})])):W("",!0)])]),C(G)]),C(Yr,{visible:n.value,status:r.value,"current-task":o.value,logs:T(t).generationLogs,progress:i.value,queue:T(t).queue,meta:d.value,hint:l.value,onClose:T(t).stopGeneration,onClick:V,onTogglePause:F,onRetryItem:B},null,8,["visible","status","current-task","logs","progress","queue","meta","hint","onClose"]),C(J,{modelValue:T(t).showKnowledgeGraph,"onUpdate:modelValue":h[13]||(h[13]=A=>T(t).showKnowledgeGraph=A),title:"üìä Áü•ËØÜÂõæË∞±",width:"90%",class:"knowledge-graph-full-dialog","destroy-on-close":""},{default:L(()=>[p("div",Wo,[C(xo)])]),_:1},8,["modelValue"])])}}}),Xo=gt(Ko,[["__scopeId","data-v-2f9e2163"]]),Zo=[{path:"/",name:"home",component:()=>vt(()=>import("./CourseView-C8njggUz.js"),__vite__mapDeps([0,1,2,3,4,5,6]))},{path:"/course/:courseId",name:"course",component:()=>vt(()=>import("./CourseView-C8njggUz.js"),__vite__mapDeps([0,1,2,3,4,5,6]))},{path:"/:pathMatch(.*)*",redirect:"/"}],ms=Ss({history:Ts("/"),routes:Zo});ms.onError(e=>{console.error("Router Error:",e),document.body.innerHTML+=`<div style="color: red; padding: 20px; z-index: 9999; position: fixed; top: 50px; left: 0; background: white; border: 2px solid orange;">
        Router Error: ${e.message}
    </div>`});try{const e=Cs(Xo),t=Is();e.use(Fs),e.use(t),e.use(ms);for(const[s,n]of Object.entries(qs))e.component(s,n);e.mount("#app")}catch(e){console.error("App Mount Error:",e)}export{xo as K,gt as _,gs as u};
